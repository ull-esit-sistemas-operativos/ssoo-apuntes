<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="JesÃºs Torres">
<title>Sistemas Operativos</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<meta name='robots' content='noindex,nofollow'>
<link rel="icon" href="media/extras/favicon.ico" sizes="any">
<link rel="icon" href="media/extras/ssoo-icon.svg" type="image/svg+xml">
<link rel="icon" type="image/png" sizes="192x192" href="media/extras/ssoo-icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="media/extras/ssoo-icon-512.png">
<link rel="apple-touch-icon" href="media/extras/ssoo-apple-touch-icon.png"><!-- 180Ã180 -->
<link rel="stylesheet" href="media/extras/inlineDisqussions.css">
<style>
    body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    content {
        flex: 1;
    }
    #preamble {
        margin-top: 0.5em;
    }
    #header, #content, #footnotes {
        margin: 0 auto 0 5em
    }
    #content h1>a.anchor, h2>a.anchor, h3>a.anchor,
    #toctitle>a.anchor, .sidebarblock>.content>.title>a.anchor,
    h4>a.anchor, h5>a.anchor, h6>a.anchor {
        color: #ba3925;
    }
    .imageblock {
        text-align: center;
    }
    .imageblock > .content {
        margin-bottom: 1rem;
    }
    .imageblock > .title {
        text-align: inherit;
    }
    .tableblock > .lightcell {
        color: gray;
    }
    table tfoot td p {
        font-weight: bold;
    }
    #footer-text {
        margin: 0 auto;
        max-width: 62.5em;
        padding-left: .9375em;
        padding-right: .9375em;
    }
    #footer-text a {
        color: hsla(0,0%,100%,.8);
        text-decoration: none;
        font-weight: bold;
    }
    #footer-text a:hover {
        color: hsla(0,0%,100%,.8);
    }
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="media/extras/inlineDisqussions.js"></script>
<script type="text/javascript">
    window.onload = function(){
        if ('true' === 'true') {
            setTimeout(function() {
                disqus_shortname = 'ull-esit-sistemas-operativos';
                jQuery("img, p, .colist td, .stemblock").not('#toc p').inlineDisqussions();
                query_params = (new URL(document.location)).searchParams;
                if (query_params.has('disqussion')) {
                    let identifier = window.location.pathname + 'disqussion-' + query_params.get('disqussion');
                    let selection = jQuery('[data-disqus-identifier="' +  identifier + '"]').not('.disqussion-link');
                    if (selection.length) {
                        selection[0].scrollIntoView(true);
                    }
                }
            }, 500);
        }
    }
</script>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
<style>
.admonitionblock td.icon .icon-time:before {content:"\f017";color:#f28500;}
</style>
</head>
<body id="memoria_virtual" class="book toc2 toc-left">
<div id="header">
<h1>Sistemas Operativos</h1>
<div class="details">
<span id="author" class="author">JesÃºs Torres</span><br>
<span id="email" class="email"><a href="mailto:jmtorres@ull.es">jmtorres@ull.es</a></span><br>
<span id="revdate">EdiciÃ³n OCW</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Tabla de Contenido</div>
<p><span class="toc-root"><a href="main.html">Sistemas Operativos</a></span></p><ul class="sectlevel1">
<li><a href="ediciones_y_licencia.html">Ediciones y licencia</a>
</li>
<li><a href="cÃ³digo_de_los_ejemplos.html">CÃ³digo de los ejemplos</a>
</li>
<li><a href="introducciÃ³n.html">Parte I: IntroducciÃ³n</a>
</li>
<li><a href="organizaciÃ³n_de_los_sistemas_operativos.html">Parte II: OrganizaciÃ³n de los sistemas operativos</a>
</li>
<li><a href="gestiÃ³n_de_procesos.html">Parte III: GestiÃ³n de procesos</a>
</li>
<li><a href="gestiÃ³n_de_la_memoria.html">Parte IV: GestiÃ³n de la memoria</a>
<ul class="sectlevel1">
<li><a href="memoria_principal.html">15. Memoria principal</a>
</li>
<li><a href="paginaciÃ³n.html">16. PaginaciÃ³n</a>
</li>
<li><a href="memoria_virtual.html"><span class="toc-current">17. Memoria virtual</span></a>
<ul class="sectlevel2">
<li><a href="memoria_virtual.html#_paginaciÃ³n_bajo_demanda">17.1. PaginaciÃ³n bajo demanda</a>
</li>
<li><a href="memoria_virtual.html#_copy_on_write">17.2. Copy-on-write</a>
</li>
<li><a href="memoria_virtual.html#_archivos_mapeados_en_memoria">17.3. Archivos mapeados en memoria</a>
</li>
<li><a href="memoria_virtual.html#_reemplazo_de_pÃ¡gina">17.4. Reemplazo de pÃ¡gina</a>
</li>
<li><a href="memoria_virtual.html#_asignaciÃ³n_de_marcos_de_pÃ¡gina">17.5. AsignaciÃ³n de marcos de pÃ¡gina</a>
</li>
<li><a href="memoria_virtual.html#_hiperpaginaciÃ³n">17.6. HiperpaginaciÃ³n</a>
</li>
<li><a href="memoria_virtual.html#_otras_consideraciones">17.7. Otras consideraciones</a>
</li>
<li><a href="memoria_virtual.html#_interfaz_de_gestiÃ³n_de_la_memoria">17.8. Interfaz de gestiÃ³n de la memoria</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="gestiÃ³n_del_almacenamiento.html">Parte V: GestiÃ³n del almacenamiento</a>
</li>
<li><a href="bibliografÃ­a.html">BibliografÃ­a</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="memoria_virtual"><a class="anchor" href="#memoria_virtual"></a>17. Memoria virtual</h2>
<div class="sectionbody">
<div class="admonitionblock time">
<table>
<tr>
<td class="icon">
<i class="fa icon-time" title=""></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Tiempo de lectura:</strong> 1 hora y 5 minutos</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>La <strong>memoria virtual</strong> es una tÃ©cnica que permite la ejecuciÃ³n de procesos sin que estos tengan que ser cargados completamente en la memoria.</p>
</div>
<div class="paragraph">
<p>Los programas suelen tener partes de cÃ³digo que rara vez son ejecutadas.
Por ejemplo, las funciones para manejar condiciones de error que, aunque Ãºtiles, generalmente nunca son invocadas.
TambiÃ©n es frecuente que se reserve mÃ¡s memoria para datos de lo que realmente es necesario.
Por ejemplo, muchos programadores tienen la costumbre de hacer cosas tales como declarar un <em>array</em> de 65536 elementos, cuando realmente solo necesitan 255.
Teniendo todo esto en cuenta, y con el fin de mejorar el aprovechamiento de la memoria, parece que serÃ­a interesante no tener que cargar todas las porciones de los procesos y que, aÃºn asÃ­, pudieran ejecutarse.
Eso es exactamente lo que proporciona la <strong>memoria virtual</strong>.</p>
</div>
<div class="paragraph">
<p>La habilidad de ejecutar un proceso cargado parcialmente en memoria proporciona algunos beneficios importantes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un programa nunca mÃ¡s estarÃ­a limitado por la cantidad de memoria disponible.</p>
<div class="paragraph">
<p>Es decir, los desarrolladores pueden escribir programas considerando que disponen de un espacio de direcciones virtual extremadamente grande, sin considerar la cantidad de memoria realmente disponible.
No debemos olvidar que sin memoria virtual, para que un proceso pueda ser ejecutado, debe estar completamente cargado en la memoria.</p>
</div>
</li>
<li>
<p>Puesto que cada programa ocupa menos memoria, mÃ¡s programas se pueden ejecutar al mismo tiempo; con el correspondiente incremento en el uso de la CPU y en el rendimiento del sistema, pero sin efectos negativos en el tiempo de respuesta y en el de ejecuciÃ³n.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El concepto de <strong>memoria virtual</strong> no debe confundirse con el de <strong>espacio de direcciones virtual</strong>.
Sin embargo estÃ¡n relacionados, puesto que el que exista separaciÃ³n entre la memoria fÃ­sica y la manera en la que los procesos perciben la memoria es un requisito para poder implementar la memoria virtual.</p>
</div>
<div class="sect2">
<h3 id="_paginaciÃ³n_bajo_demanda"><a class="anchor" href="#_paginaciÃ³n_bajo_demanda"></a>17.1. PaginaciÃ³n bajo demanda</h3>
<div class="paragraph">
<p>La <strong>paginaciÃ³n bajo demanda</strong> es la tÃ©cnica con la que frecuentemente se implementa la <strong>memoria virtual</strong> en los sistemas con paginaciÃ³n.</p>
</div>
<div class="paragraph">
<p>En la <strong>paginaciÃ³n bajo demanda</strong> las pÃ¡ginas individuales, en las que se dividen los espacios de direcciones virtuales de los diferentes procesos, pueden ser sacadas de la memoria de manera temporal y copiadas a un almacenamiento de respaldo, para posteriormente volver a ser traÃ­das a la memoria cuando son necesitadas por su proceso.
A este proceso de guardado y recuperaciÃ³n de las pÃ¡ginas sobre el almacenamiento de respaldo se lo denomina <strong>intercambio</strong> o <strong><em>swapping</em></strong> y es llevado a cabo por un componente del sistema operativo denominado el <strong>paginador</strong>.</p>
</div>
<div class="paragraph">
<p>Para que se puedan cargar las pÃ¡ginas cuando son necesitadas por su proceso, hace falta que el <strong>paginador</strong> sepa cuÃ¡ndo lo son.
Eso requiere que el hardware proporcione algÃºn tipo de soporte, por ejemplo, incorporando un <strong>bit de vÃ¡lido</strong> a la entrada de cada pÃ¡gina en la tabla de pÃ¡ginas, que se utiliza de la siguiente manera:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cuando el <strong>bit de vÃ¡lido</strong> estÃ¡ a 1 la pÃ¡gina es legal y estÃ¡ en la memoria.
Es decir, la pÃ¡gina existe en el espacio de direcciones virtual del proceso y tiene asignado un marco de memoria fÃ­sica.</p>
</li>
<li>
<p>Cuando el <strong>bit de vÃ¡lido</strong> estÃ¡ a 0, pueden ocurrir varias cosas:</p>
<div class="ulist">
<ul>
<li>
<p>La pÃ¡gina es legal, pero estÃ¡ almacenada en disco y no en la memoria.</p>
</li>
<li>
<p>La pÃ¡gina no es legal.
Es decir, no existe en el espacio de direcciones virtual del proceso.</p>
<div class="paragraph">
<p>Esto puede ser debido a que la pÃ¡gina estÃ© en un hueco del espacio de direcciones âen una regiÃ³n que no estÃ¡ siendo utilizadaâ por lo que el sistema operativo no le ha asignado espacio de almacenamiento ni en disco ni en la memoria.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si un proceso accede a una pÃ¡gina legal, no ocurre nada y la instrucciÃ³n se ejecuta con normalidad.
Pero si accede a una pÃ¡gina marcada como invÃ¡lida:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Al intentar acceder a la pÃ¡gina, la MMU comprueba el bit de vÃ¡lido y genera una excepciÃ³n de <strong>fallo de pÃ¡gina</strong> al estar marcada como invÃ¡lida.
Dicha excepciÃ³n es capturada por el sistema operativo.</p>
</li>
<li>
<p>El sistema operativo comprueba en una tabla interna si la pÃ¡gina es legal o no.
Es decir, si la pÃ¡gina realmente no pertenece al espacio de direcciones virtual del proceso o si pertenece, pero estÃ¡ almacenada en el disco.
Esta tabla interna suele almacenarse en el PCB del proceso como parte de la informaciÃ³n de gestiÃ³n de la memoria.</p>
</li>
<li>
<p>Si la pÃ¡gina es ilegal, el proceso ha cometido un error y debe ser terminado.
En sistemas POSIX, por ejemplo, el sistema envÃ­a al proceso una seÃ±al de <strong>violaciÃ³n de segmento</strong> que lo obliga a terminar.</p>
</li>
<li>
<p>Si la pÃ¡gina es legal, se carga desde el disco:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>El nÃºcleo busca un marco de memoria libre que, por ejemplo, se puede escoger de la lista de marcos libres del sistema.</p>
</li>
<li>
<p>Se solicita una operaciÃ³n de disco para leer la pÃ¡gina deseada en el marco asignado.</p>
<div class="paragraph">
<p>Puesto que no resulta eficiente mantener la CPU ocupada mientras la pÃ¡gina es recuperada desde el disco, el sistema debe solicitar la lectura de la pÃ¡gina y poner al proceso en estado <strong>esperando</strong>.</p>
</div>
</li>
<li>
<p>Cuando la lectura del disco haya terminado, se modifica la tabla interna, antes mencionada, y la tabla de pÃ¡ginas para indicar que la pÃ¡gina estÃ¡ en la memoria.</p>
</li>
<li>
<p>Reiniciar la instrucciÃ³n que fue interrumpida por la excepciÃ³n.
Generalmente esto se hace colocando el proceso nuevamente en la <strong>cola de preparados</strong> y dejando que el <strong>asignador</strong> lo reinicie cuando sea escogido por el <strong>planificador</strong> de la CPU.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Un caso extremo de la paginaciÃ³n bajo demanda es la <strong>paginaciÃ³n bajo demanda pura</strong>.
En ella la ejecuciÃ³n de un proceso se inicia sin cargar ninguna pÃ¡gina en la memoria.
Cuando el sistema operativo sitÃºa el contador de programa en la primera instrucciÃ³n del proceso âque es una pÃ¡gina no residente en memoriaâ se genera inmediatamente un <strong>fallo de pÃ¡gina</strong>.
La pÃ¡gina es cargada en la memoria âtal y como hemos descrito anteriormenteâ y el proceso continÃºa ejecutÃ¡ndose, fallando cuando sea necesario con cada pÃ¡gina que necesite y no estÃ© cargada.
Las principales ventajas de la <strong>paginaciÃ³n bajo demanda pura</strong> son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nunca se trae desde el disco una pÃ¡gina que no sea necesaria.</p>
</li>
<li>
<p>El inicio de la ejecuciÃ³n de un proceso es mucho mÃ¡s rÃ¡pido que si se cargara todo el proceso desde el principio.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_requerimientos_de_la_paginaciÃ³n_bajo_demanda"><a class="anchor" href="#_requerimientos_de_la_paginaciÃ³n_bajo_demanda"></a>17.1.1. Requerimientos de la paginaciÃ³n bajo demanda</h4>
<div class="paragraph">
<p>Los requerimientos hardware para que un sistema operativo pueda soportar la <strong>paginaciÃ³n bajo demanda</strong> son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tabla de pÃ¡ginas con habilidad para marcar entradas invÃ¡lidas, ya sea utilizando un bit especÃ­fico o con valores especiales en los bits de protecciÃ³n.</p>
</li>
<li>
<p>Disponibilidad de un dispositivo de almacenamiento secundario.</p>
<div class="paragraph">
<p>En este dispositivo se guardan las pÃ¡ginas que no estÃ¡n presentes en la memoria principal.
Normalmente se trata de un disco conocido como <strong>dispositivo de intercambio</strong>, mientras que la secciÃ³n de disco utilizada concretamente para dicho propÃ³sito se conoce como <strong>espacio de intercambio</strong> o <strong><em>swap</em></strong>.</p>
</div>
</li>
<li>
<p>Posibilidad de reiniciar cualquier instrucciÃ³n despuÃ©s de un fallo de pÃ¡gina.</p>
<div class="paragraph">
<p>En la mayor parte de los casos esta funcionalidad es sencilla de conseguir.
Sin embargo, la mayor dificultad proviene de las instrucciones que pueden modificar diferentes posiciones de la memoria, como aquellas pensadas para mover bloques de bytes o palabras.
En el caso de que el bloque de origen o de destino atraviese un borde de pÃ¡gina, la instrucciÃ³n serÃ­a interrumpida cuando la operaciÃ³n solo haya sido realizada parcialmente.
Si ademÃ¡s ambos bloques se superpusieran, no se podrÃ­a reiniciar la instrucciÃ³n completa.
Las posibles soluciones a este problema deben ser implementadas en la CPU.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_rendimiento_de_la_paginaciÃ³n_bajo_demanda"><a class="anchor" href="#_rendimiento_de_la_paginaciÃ³n_bajo_demanda"></a>17.1.2. Rendimiento de la paginaciÃ³n bajo demanda</h4>
<div class="paragraph">
<p>Indudablemente, el rendimiento de un sistema con <strong>paginaciÃ³n bajo demanda</strong> se ve afectado por el <strong>nÃºmero de fallos de pÃ¡ginas</strong>.
En el peor de los casos, en cada instrucciÃ³n un proceso puede intentar acceder a una pÃ¡gina distinta, empeorando notablemente el rendimiento.
Sin embargo, esto no ocurre, puesto que los programas tienden a tener localidad de referencia (vÃ©ase el <a href="memoria_virtual.html#_hiperpaginaciÃ³n">Apartado 17.6</a>).</p>
</div>
<div class="sect4">
<h5 id="_tiempo_de_acceso_efectivo"><a class="anchor" href="#_tiempo_de_acceso_efectivo"></a>Tiempo de acceso efectivo</h5>
<div class="paragraph">
<p>Como con la <strong>paginaciÃ³n</strong>, el rendimiento de un sistema con <strong>paginaciÃ³n bajo demanda</strong> tambiÃ©n estÃ¡ relacionado con el concepto de <strong>tiempo de acceso efectivo</strong> a la memoria, que intenta estimar el tiempo que realmente se tarda en acceder a la memoria teniendo en cuenta mecanismos del sistema operativo.</p>
</div>
<div class="paragraph">
<p>Supongamos que conocemos la probabilidad <em>p<sub>fp</sub></em> de que ocurra un fallo de pÃ¡gina.
El <strong>tiempo de acceso efectivo</strong> se podrÃ­a calcular como la probabilidad de que no ocurra un fallo de pÃ¡gina (1 - <em>p<sub>fp</sub></em>) por el <strong>tiempo de acceso</strong> a la memoria <em>T<sub>m</sub></em>, mÃ¡s la probabilidad de que ocurra un fallo de pÃ¡gina <em>p</em> por el tiempo necesario para gestionar cada fallo de pÃ¡gina âo <strong>tiempo de fallo de pÃ¡gina</strong>â <em>T<sub>fp</sub></em>:</p>
</div>
<div class="stemblock">
<div class="content">
\[T_{em}=(1-p_{fp}) T_m+p_{fp} T_{fp}\]
</div>
</div>
<div class="paragraph">
<p>Por tanto, para calcular el <strong>tiempo de acceso efectivo</strong> <em>T<sub>em</sub></em> necesitamos estimar el <strong>tiempo de fallo de pÃ¡gina</strong> <em>T<sub>fp</sub></em>, que se consume fundamentalmente en:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Servir la excepciÃ³n de fallo de pÃ¡gina.</p>
<div class="paragraph">
<p>Esto incluye capturar la interrupciÃ³n, salvar los registros y el estado del proceso, determinar que la interrupciÃ³n es debida a una excepciÃ³n de <strong>fallo de pÃ¡gina</strong>, comprobar si la pÃ¡gina es legal y determinar la localizaciÃ³n de la misma en el disco.
Aproximadamente, en realizar esta tarea el sistema puede tardar de 1 a 100 Î¼s.</p>
</div>
</li>
<li>
<p>Leer la pÃ¡gina en un marco libre.
En esta tarea se puede tardar alrededor de 8 ms, pero este tiempo puede ser mucho mayor si el dispositivo estÃ¡ ocupado y se debe esperar a que se realicen otras operaciones.</p>
</li>
<li>
<p>Reiniciar el proceso.
Si incluimos el tiempo de espera en la cola de preparados, se puede tardar entre 1 y 100 Î¼s.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Como se puede apreciar, la mayor parte del <strong>tiempo de fallo de pÃ¡gina</strong> es debido al tiempo requerido para acceder al <strong>dispositivo de intercambio</strong>.</p>
</div>
<div class="paragraph">
<p>Para ilustrar el cÃ¡lculo del <strong>tiempo de acceso efectivo</strong> a la memoria, solo vamos a considerar el tiempo requerido para acceder al <strong>dispositivo de intercambio</strong>, ignorando las otras tareas a realizar durante el <strong>fallo de pÃ¡gina</strong>, ya que comparativamente consumen mucho menos tiempo.
Vamos suponer que el <strong>tiempo de acceso</strong> a la memoria <em>T<sub>m</sub></em> es de 200 ns y que la probabilidad <em>p<sub>fp</sub></em> es muy pequeÃ±a âes decir, p &#8810; 1â:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{split}
T_{em} &amp;= (1-p_{fp}) \cdot 200\,\text{ns}+p_{fp} \cdot 8\,\text{ms.} \\
       &amp;= (1-p_{fp}) \cdot 200\,\text{ns}+p_{fp} \cdot 8\,000\,000\,\text{ms.} \\
       &amp;\approx 200\,\text{ns} + 7\,999\,800\,\text{ms.} \cdot p
\end{split}\]
</div>
</div>
<div class="paragraph">
<p>Como se puede apreciar el <strong>tiempo de acceso efectivo</strong> es proporcional a la <strong>tasa de fallos de pÃ¡gina</strong> <em>&#964;<sub>fp</sub></em>:</p>
</div>
<div class="stemblock">
<div class="content">
\$T_(em) approx T_(m) + tau_(fp)\$
</div>
</div>
<div class="paragraph">
<p>donde:</p>
</div>
<div class="stemblock">
<div class="content">
\$tau_(fp)=p_(fp) T_(fp)\$
</div>
</div>
<div class="paragraph">
<p>Por ejemplo, si un proceso causa un fallo de pÃ¡gina en uno de cada 1000 accesos âes decir, <em>p<sub>fp</sub> =</em> 0.001â el <strong>tiempo de acceso efectivo</strong> es de 8.2 ms, por lo que el rendimiento del sistema es 40 veces inferior debido a la <strong>paginaciÃ³n bajo demanda</strong>.
Por tanto, es necesario mantener la <strong>tasa de fallos de pÃ¡gina</strong> <em>&#964;<sub>fp</sub></em> lo mÃ¡s baja posible para mantener un rendimiento adecuado.</p>
</div>
<div class="paragraph">
<p>Por simplicidad, por el momento hemos considerado <em>T<sub>m</sub></em> como el tiempo de acceso a la memoria fÃ­sica.
Sin embargo, realmente estamos en un sistema que utiliza paginaciÃ³n âincluso con varios nivelesâ y que puede tener una TLB para mejorar su rendimiento.
Entonces, si queremos ser mÃ¡s precisos, podemos considerar <em>T<sub>m</sub></em> como el <strong>tiempo de acceso efectivo</strong> que vimos en el <a href="paginaciÃ³n.html#_tiempos_de_acceso_a_la_memoria">Apartado 16.2.3.3</a> para el mÃ©todo bÃ¡sico de paginaciÃ³n.
Por lo que sustituyÃ©ndolo en la expresiÃ³n anterior:</p>
</div>
<div class="stemblock">
<div class="content">
\[T_{em} \approx (2-p_{tlb}) T_m + tau_{fp}\]
</div>
</div>
<div class="paragraph">
<p>donde <em>p<sub>tlb</sub></em> es la probabilidad de que una entrada estÃ© en la TLB y <em>T<sub>m</sub></em> ahora sÃ­ es el <strong>tiempo de acceso</strong> a la memoria fÃ­sica.</p>
</div>
</div>
<div class="sect4">
<h5 id="_manejo_y_uso_del_espacio_de_intercambio"><a class="anchor" href="#_manejo_y_uso_del_espacio_de_intercambio"></a>Manejo y uso del espacio de intercambio</h5>
<div class="paragraph">
<p>Otro aspecto fundamental que afecta al rendimiento de la <strong>paginaciÃ³n bajo demanda</strong> es el uso del espacio de intercambio.</p>
</div>
<div class="paragraph">
<p>Cuando un proceso genera un <strong>fallo de pÃ¡gina</strong>, el sistema operativo debe recuperar la pÃ¡gina de allÃ­ donde estÃ© almacenada.
Si esto ocurre al principio de la ejecuciÃ³n, ese lugar seguramente serÃ¡ el archivo que contiene la imagen binaria del programa, pues es donde se encuentran las pÃ¡ginas en su estado inicial.
Sin embargo, el acceso al espacio de intercambio es mucho mÃ¡s eficiente que el acceso a un sistema de archivos, incluso aunque el primero estÃ© almacenado dentro de un archivo de gran tamaÃ±o.
Esto es debido a que los datos se organizan en bloques contiguos de gran tamaÃ±o, se evitan las bÃºsquedas de archivos y las indirecciones en la asignaciÃ³n de espacio.
Por ello debemos plantearnos quÃ© hacer con las imÃ¡genes de los programas que van a ser ejecutados.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se puede mejorar el rendimiento copiando en el espacio de intercambio la imagen completa de los programas durante el inicio del proceso, para despuÃ©s realizar la <strong>paginaciÃ³n bajo demanda</strong> sobre dicha copia.</p>
</li>
<li>
<p>Otra alternativa es cargar las pÃ¡ginas desde el archivo que contiene la imagen cuando son usadas por primera vez, pero siendo escritas en el espacio de intercambio cuando dichas pÃ¡ginas tienen que ser reemplazadas.
Esta aproximaciÃ³n garantiza que solo las pÃ¡ginas necesarias son leÃ­das desde el sistema de archivos, reduciendo el uso de espacio de intercambio, mientras que las siguientes operaciones de intercambio se hacen sobre dicho espacio.</p>
</li>
<li>
<p>TambiÃ©n se puede suponer que el cÃ³digo de los procesos no puede cambiar.
Esto permite utilizar el archivo de la imagen binaria para recargar las pÃ¡ginas de cÃ³digo, lo que tambiÃ©n evita escribirlas cuando son sustituidas.
Sin embargo, el espacio de intercambio se sigue utilizando para las pÃ¡ginas que no estÃ¡n directamente asociadas a un archivo, como la pila o el montÃ³n de los procesos.</p>
<div class="paragraph">
<p>Este Ãºltimo mÃ©todo parece conseguir un buen compromiso entre el tamaÃ±o del espacio de intercambio y el rendimiento.
Por eso se utiliza en la mayor parte de los sistemas operativos modernos.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_copy_on_write"><a class="anchor" href="#_copy_on_write"></a>17.2. Copy-on-write</h3>
<div class="paragraph">
<p>
El <strong><em>copy-on-write</em></strong> o <strong>copia durante la escritura</strong> permite la creaciÃ³n rÃ¡pida de nuevos procesos, minimizando la cantidad de pÃ¡ginas que deben ser asignadas a estos.</p>
</div>
<div class="paragraph">
<p>Para entenderlo, es importante recordar que la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/fork.2.html">fork()</a> crea un proceso hijo cuyo espacio de direcciones es un duplicado del espacio de direcciones del padre.
Indudablemente, esto significa que durante la llamada es necesario asignar suficientes marcos de memoria fÃ­sica como para alojar las pÃ¡ginas del nuevo proceso hijo.
El <strong><em>copy-on-write</em></strong> minimiza de la siguiente manera el nÃºmero de marcos que deben ser asignadas al nuevo proceso:</p>
</div>
<div id="fig-copy-on-write-1" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/copy_on_write1.svg" alt="copy on write1">
</div>
<div class="title">Figura 57. Copy-on-write antes de que el proceso 1 modifique la pÃ¡gina A.</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Cuando la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/fork.2.html">fork()</a> crea el nuevo proceso lo hace de forma que este comparta todas sus pÃ¡ginas con las del padre (vÃ©ase la <a href="memoria_virtual.html#fig-copy-on-write-1">Figura 57</a>).</p>
<div class="paragraph">
<p>Sin el <strong><em>copy-on-write</em></strong> el <a href="https://man7.org/linux/man-pages/man2/fork.2.html">fork()</a> tendrÃ­a que asignar marcos de memoria fÃ­sica al hijo, para a continuaciÃ³n copiar las pÃ¡ginas del padre en ellos.
Sin embargo, con el <strong><em>copy-on-write</em></strong> padre e hijo mapean sus pÃ¡ginas en los mismos marcos, evitando tener que asignar memoria libre.</p>
</div>
</li>
<li>
<p>Las pÃ¡ginas compartidas se marcan como <strong><em>copy-on-write</em></strong>.</p>
<div class="paragraph">
<p>Para ello se pueden marcar todas las pÃ¡ginas como de <strong>solo lectura</strong> en la tabla de pÃ¡ginas de ambos procesos y utilizar una tabla interna alojada en el PCB para indicar cuÃ¡les son realmente de solo lectura y cuÃ¡les estÃ¡n en <strong><em>copy-on-write</em></strong>.
Es importante destacar que realmente solo las pÃ¡ginas que pueden ser modificadas se marcan como <strong><em>copy-on-write</em></strong>. Las pÃ¡ginas que no pueden ser modificadas âpor ejemplo, las que contienen el cÃ³digo ejecutable del programaâ simplemente pueden ser compartidas como de solo lectura por los procesos, como hemos comentado anteriormente.</p>
</div>
</li>
<li>
<p>Si algÃºn proceso intenta escribir en una pÃ¡gina <strong><em>copy-on-write</em></strong>, la MMU genera una excepciÃ³n para notificar el suceso al sistema operativo.
Siguiendo lo indicado en el punto anterior, la excepciÃ³n se originarÃ­a porque la pÃ¡gina estÃ¡ marcada como de solo lectura, por lo que el sistema operativo comprobarÃ¡ si se trata de un acceso a una pÃ¡gina <strong><em>copy-on-write</em></strong> o a un intento real de escribir en una pÃ¡gina de solo lectura.
Para ello, el sistema solo tiene que mirar la tabla interna almacenada en el PCB.
Si se ha intentado escribir en una pÃ¡gina de solo lectura, el proceso ha cometido un error y generalmente serÃ¡ terminado.</p>
</li>
</ol>
</div>
<div id="fig-copy-on-write-2" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/copy_on_write2.svg" alt="copy on write2">
</div>
<div class="title">Figura 58. Copy-on-write despuÃ©s de que el proceso 1 modifique la pÃ¡gina A.</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Si el sistema detecta una escritura a una pÃ¡gina de <strong><em>copy-on-write</em></strong> solo tiene que copiarla en un marco libre y mapearlo en el espacio de direcciones del proceso (vÃ©ase la <a href="memoria_virtual.html#fig-copy-on-write-2">Figura 58</a>).</p>
<div class="paragraph">
<p>Para esto se sustituye la pÃ¡gina compartida por otra que contiene una copia, pero que ya no estÃ¡ compartida.
Obviamente, la nueva pÃ¡gina debe ser marcada como de escritura para que en el futuro pueda ser modificada por el proceso.</p>
</div>
</li>
<li>
<p>La pÃ¡gina original marcada como <strong><em>copy-on-write</em></strong> puede ser marcada como de escritura y no como <strong><em>copy-on-write</em></strong>, pero solo si no va a seguir siendo compartida.
Esto es asÃ­ porque una pÃ¡gina marcada como <strong><em>copy-on-write</em></strong> puede estar siendo compartida con otros procesos.</p>
</li>
<li>
<p>El sistema operativo puede reiniciar el proceso.
A partir de ahora, este puede escribir en la pÃ¡gina sin afectar al resto de los procesos.
Sin embargo, puede seguir compartiendo otras pÃ¡ginas en <strong><em>copy-on-write</em></strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>El <strong><em>copy-on-write</em></strong> permite ahorrar memoria y tiempo en la creaciÃ³n de los procesos, puesto que solo se copian las pÃ¡ginas que son modificadas por estos.
Por eso se trata de una tÃ©cnica comÃºn en mÃºltiples sistemas operativos, como por ejemplo los sistemas POSIX modernos y Microsoft Windows.</p>
</div>
<div class="paragraph">
<p>El <strong><em>copy-on-write</em></strong> es especialmente interesante si a continuaciÃ³n se va a utilizar la llamada al sistema <a href="https://man7.org/linux/man-pages/man3/exec.3.html">exec()</a> puesto que si es asÃ­, copiar el espacio de direcciones completo es una pÃ©rdida de tiempo.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archivos_mapeados_en_memoria"><a class="anchor" href="#_archivos_mapeados_en_memoria"></a>17.3. Archivos mapeados en memoria</h3>
<div class="paragraph">
<p>
Los <strong>archivos mapeados en memoria</strong> permiten acceder a un archivo como parte del espacio de direcciones virtuales de un proceso.
Algunas de las caracterÃ­sticas de esta tÃ©cnica son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cuando una regiÃ³n del espacio de direcciones queda marcada para ser mapeada sobre una regiÃ³n de un archivo, se utiliza una estrategia similar a la comentada para el mÃ©todo bÃ¡sico de la paginaciÃ³n bajo demanda.
La diferencia es que las pÃ¡ginas son cargadas desde dicho archivo y no desde el espacio de intercambio.
Es decir, en un primer acceso a una pÃ¡gina mapeada se produce un <strong>fallo de pÃ¡gina</strong> que es resuelto por el sistema operativo leyendo una porciÃ³n del archivo en el marco asignado a la pÃ¡gina.</p>
</li>
<li>
<p>Esto significa que la lectura y escritura del archivo se realiza a travÃ©s de lecturas y escrituras en la memoria, lo que simplifica el acceso y elimina el costo adicional de las llamadas al sistema: <a href="https://man7.org/linux/man-pages/man2/read.2.html">read()</a>, <a href="https://man7.org/linux/man-pages/man2/write.2.html">write()</a>, etc.</p>
</li>
<li>
<p>Las escrituras en disco se suelen realizar de forma asÃ­ncrona.
Es decir, los datos no se escriben inmediatamente en disco cuando se modifica la pÃ¡gina, sino que el sistema operativo comprueba periÃ³dicamente las pÃ¡ginas modificadas y las escribe en disco.</p>
</li>
<li>
<p>Los marcos utilizados en el mapeo pueden ser compartidos, lo que permite compartir los datos de los archivos.
AdemÃ¡s, se puede incluir soporte de <strong><em>copy-on-write</em></strong>, lo que permite a los procesos compartir buena parte de un archivo en modo de solo lectura, pero disponiendo de sus propias copias de aquellas pÃ¡ginas que modifiquen.</p>
<div class="paragraph">
<p>Indudablemente, para que los procesos puedan compartir datos es necesario que exista algÃºn tipo de coordinaciÃ³n (vÃ©ase el <a href="sincronizaciÃ³n.html">CapÃ­tulo 13</a>).</p>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ejemplo_de_mapeo_de_archivos"><a class="anchor" href="#_ejemplo_de_mapeo_de_archivos"></a>17.3.1. Ejemplo de mapeo de archivos</h4>
<div class="paragraph">
<p>Tanto en los sistemas POSIX como en Windows API el archivo a mapear hay que abrirlo con la llamada al sistema destinada a ello.
Por ejemplo, en sistemas POSIX:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span> <span class="s">"foo.txt"</span><span class="p">,</span> <span class="n">O_RDONLY</span> <span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En la API POSIX con esto es suficiente para usar la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> y mapear el archivo en memoria:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">lseek</span><span class="p">(</span> <span class="n">fd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_END</span> <span class="p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="kt">void</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span>
    <span class="nb">NULL</span><span class="p">,</span>
    <span class="n">length</span><span class="p">,</span>                 <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="n">PROT_READ</span><span class="p">,</span>              <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="n">MAP_SHARED</span><span class="p">,</span>
    <span class="n">fd</span><span class="p">,</span>                     <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="mi">0</span>                       <i class="conum" data-value="3"></i><b>(3)</b>
<span class="p">);</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Descriptor del archivo abierto con <a href="https://man7.org/linux/man-pages/man2/open.2.html">open()</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>La longitud de la regiÃ³n del archivo a mapear.
Si queremos mapear todo el archivo, podemos usar <a href="https://www.man7.org/linux/man-pages/man2/lseek.2.html">lseek()</a> para conocer su longitud.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Si no se mapea todo el archivo, se puede indicar la posiciÃ³n del archivo donde comenzar el mapeo.
Esta posiciÃ³n debe ser mÃºltiplo del tamaÃ±o de pÃ¡gina.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Permisos de la memoria mapeada.
Deben coincidir con el modo con el que se abriÃ³ el archivo.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Una vez mapeado el archivo, si no se van a crear mÃ¡s mapeos, se puede cerrar el descriptor de archivo con <a href="https://man7.org/linux/man-pages/man2/close.2.html">close()</a>.
Y la regiÃ³n de memoria mapeada se puede liberar, al terminar, con <a href="https://man7.org/linux/man-pages/man2/munmap.2.html">munmap()</a>.</p>
</div>
<div class="paragraph">
<p>En <a href="https://github.com/ull-esit-sistemas-operativos/ssoo-ejemplos/blob/ocw/src/cap17/mapped-files.c">mapped-files.c</a> se puede ver un ejemplo de un programa que cuenta el nÃºmero de lÃ­neas, palabra y caracteres de un archivo.
Para acceder al archivo, primero lo mapea en memoria, para asÃ­ poder acceder a su contenido sin tener que leerlo usando <a href="https://man7.org/linux/man-pages/man2/read.2.html">read()</a>.
Una vez ha terminado, libera la memoria mapeada.</p>
</div>
<div class="paragraph">
<p>El ejemplo en <a href="https://github.com/ull-esit-sistemas-operativos/ssoo-ejemplos/blob/ocw/src/cap17/mapped-files.cpp">mapped-files.cpp</a> es identico al de <a href="https://github.com/ull-esit-sistemas-operativos/ssoo-ejemplos/blob/ocw/src/cap17/mapped-files.c">mapped-files.c</a>, pero desarrollado en C&#43;&#43;.
Usa la clase definida en <a href="https://github.com/ull-esit-sistemas-operativos/ssoo-ejemplos/blob/ocw/src/cap17/memory_map.hpp">memory_map.hpp</a> para abstraer la gestiÃ³n del mapeo del archivo, por lo que en la implementaciÃ³n de sus mÃ©todos, obviamente, se utilizan las mismas llamadas al sistema que en <a href="https://github.com/ull-esit-sistemas-operativos/ssoo-ejemplos/blob/ocw/src/cap17/mapped-files.c">mapped-files.c</a>.
Este ejemplo es algo mÃ¡s complejo porque tambiÃ©n muestra como manejar el puntero a la memoria mapeada de forma que sea liberada automÃ¡ticamente cuando ya no es necesaria, siguiendo las pautas recomendadas en C&#43;&#43;.</p>
</div>
<div class="paragraph">
<p>Con Windows API el proceso requiere un paso mÃ¡s. Primero hay que usar el manejador del archivo abierto para crear un <strong>objeto de mapeo de archivo</strong> con <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createfilemappinga">CreateFileMapping()</a>.
DespuÃ©s, el manejador devuelto por <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createfilemappinga">CreateFileMapping()</a> es usado con <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile">MapViewOfFile()</a> para mapear el archivo en la memoria del proceso.</p>
</div>
<div class="paragraph">
<p>Para liberar la memoria mapeada, se utiliza <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile">UnmapViewOfFile()</a>.
Mientras que para cerrar el manejador del <strong>objeto de mapeo de archivo</strong> se usa <a href="https://docs.microsoft.com/en-us/windows/win32/api/handleapi/nf-handleapi-closehandle">CloseHandle()</a>, como es habitual.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mapeo_de_archivos_en_el_nÃºcleo"><a class="anchor" href="#_mapeo_de_archivos_en_el_nÃºcleo"></a>17.3.2. Mapeo de archivos en el nÃºcleo</h4>
<div class="paragraph">
<p>Algunos sistemas operativos ofrecen el servicio de mapeo de archivos en la memoria solo a travÃ©s de una llamada al sistema concreta, permitiendo utilizar las llamadas estÃ¡ndar â<a href="https://man7.org/linux/man-pages/man2/read.2.html">read()</a>, <a href="https://man7.org/linux/man-pages/man2/write.2.html">write()</a>, etc.â para hacer uso de la E/S tradicional.
Sin embargo, muchos sistemas modernos utilizan el mapeo en la memoria independientemente de que se pidan o no.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, en los sistemas POSIX, si un proceso utiliza llamada al sistema <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> es porque explÃ­citamente pide que el archivo sea mapeado en memoria.
Por tanto, el nÃºcleo mapea el archivo en el espacio de direcciones del proceso.</p>
</div>
<div class="paragraph">
<p>Pero en Linux, Microsoft Windows y otros sistemas operativos modernos, adicionalmente, cuando un archivo es abierto con la llamada al sistema estÃ¡ndar âcomo <strong>open</strong>â el archivo es mapeado en el espacio de direcciones del nÃºcleo y las llamadas <strong>read</strong> y <strong>write</strong> son traducidas en accesos a la memoria en dicha regiÃ³n.
No importa como sea abierto el archivo.
Estos sistemas tratan toda la E/S a archivos como mapeada en memoria, permitiendo que el acceso a los mismos, tenga lugar a travÃ©s del eficiente componente de gestiÃ³n de la memoria.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reemplazo_de_pÃ¡gina"><a class="anchor" href="#_reemplazo_de_pÃ¡gina"></a>17.4. Reemplazo de pÃ¡gina</h3>
<div class="paragraph">
<p>Hasta el momento hemos considerado que disponemos de memoria fÃ­sica suficiente para atender cualquier fallo de pÃ¡gina, pero Â¿quÃ© ocurre cuando no quedan marcos libres?.
En ese caso el cÃ³digo que da servicio a la excepciÃ³n de <strong>fallo de pÃ¡gina</strong> debe escoger alguna pÃ¡gina, intercambiarla con el disco y utilizar el marco de la misma para cargar la nueva pÃ¡gina.
Es decir, debemos modificar la funciÃ³n que ejecuta los pasos descritos en el <a href="memoria_virtual.html#_paginaciÃ³n_bajo_demanda">Apartado 17.1</a> de la siguiente manera:</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Si la pÃ¡gina es legal, debe ser cargada desde el disco.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Buscar la localizaciÃ³n de la pÃ¡gina en disco.</p>
</li>
<li>
<p>El nÃºcleo debe buscar un marco de memoria libre que, por ejemplo, se puede escoger de la lista de marcos libres del sistema.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Si hay uno, usarlo.</p>
</li>
<li>
<p>Si no hay, usar un <strong>algoritmo de reemplazo de pÃ¡gina</strong> para seleccionar una vÃ­ctima.</p>
</li>
<li>
<p>Escribir la vÃ­ctima en el disco y cambiar las <strong>tablas de pÃ¡ginas y de marcos libres</strong> de acuerdo a la nueva situaciÃ³n.
Para evitar mantener la CPU ocupada, el sistema debe solicitar la escritura de la pÃ¡gina y poner al proceso en estado de <strong>esperando</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Se solicita una operaciÃ³n de disco para leer la pÃ¡gina deseada en el marco asignado.
Para evitar mantener la CPU ocupada, el sistema debe solicitar la escritura de la pÃ¡gina y poner al proceso en estado de <strong>esperando</strong>.</p>
</li>
<li>
<p>Cuando la lectura del disco haya terminado, se debe modificar la tabla interna de pÃ¡ginas vÃ¡lidas, y la tabla de pÃ¡ginas para indicar que la pÃ¡gina estÃ¡ en la memoria.</p>
</li>
<li>
<p>Reiniciar la instrucciÃ³n que fue interrumpida por la excepciÃ³n.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Es importante destacar que en caso de <strong>reemplazo</strong> se necesita realizar dos accesos al disco.
Esto se puede evitar utilizando un <strong>bit de modificado</strong> asociado a cada entrada en la <strong>tabla de pÃ¡ginas</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Este bit es puesto a 1 por el hardware cuando se escribe en la pÃ¡gina.</p>
</li>
<li>
<p>Se puede evitar escribir en disco aquellas pÃ¡ginas que tienen este bit a 0 cuando son seleccionadas para reemplazo, siempre que el contenido de la pÃ¡gina no haya sido sobrescrito por otra en el espacio de intercambio.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En general, para implementar la paginaciÃ³n bajo demanda necesitamos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un <strong>algoritmo de asignaciÃ³n de marcos</strong>, que se encarga de asignar los marcos a los procesos.</p>
</li>
<li>
<p>Un <strong>algoritmo de reemplazo de pÃ¡gina</strong> para seleccionar quÃ© pÃ¡gina reemplazamos cuando no hay marcos suficientes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Obviamente, estos algoritmos deben ser escogidos de forma que mantengan la <strong>tasa de fallos de pÃ¡gina</strong> lo mÃ¡s baja posible para perjudicar en lo mÃ­nimo el rendimiento del sistema.</p>
</div>
<div class="sect3">
<h4 id="_algoritmos_de_reemplazo_de_pÃ¡ginas"><a class="anchor" href="#_algoritmos_de_reemplazo_de_pÃ¡ginas"></a>17.4.1. Algoritmos de reemplazo de pÃ¡ginas</h4>
<div class="paragraph">
<p>
Hay muchos <strong>algoritmos de reemplazo de pÃ¡gina</strong>.
La cuestiÃ³n es cÃ³mo seleccionar uno en particular, sabiendo que debe tener la menor tasa posible de <strong>fallos de pÃ¡gina</strong>.</p>
</div>
<div class="sect4">
<h5 id="_trazas_de_referencias"><a class="anchor" href="#_trazas_de_referencias"></a>Trazas de referencias</h5>
<div class="paragraph">
<p>
Podemos evaluar el algoritmo utilizando una secuencia de referencias a memoria y calculando el nÃºmero de <strong>fallos de pÃ¡gina</strong>.
A dicha secuencia de referencias se la denomina <strong>trazas de referencias</strong>.</p>
</div>
<div class="paragraph">
<p>Las trazas pueden ser obtenidas aleatoriamente u obteniÃ©ndolas a partir de las que hace un proceso en un sistema real.
Indudablemente, esta Ãºltima alternativa puede proporcionar miles de millones de referencias.
Para reducir el nÃºmero de datos podemos hacer dos cosas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>De cada referencia solo necesitamos considerar el nÃºmero de pÃ¡gina.</p>
</li>
<li>
<p>Si tenemos una referencia a la pÃ¡gina <em>p</em>, cualquier referencia inmediatamente posterior a dicha pÃ¡gina <em>p</em> nunca provocarÃ¡ un fallo de pÃ¡gina, por lo que podemos ignorarlas.
Esto no tendrÃ­a por quÃ© ser cierto y si consideramos que hay varios procesos en el sistema y unos pueden expropiar a los otros.
Pero por simplicidad, ese no es nuestro caso.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Por ejemplo, si obtenemos la siguiente traza de un proceso particular:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0100, 0432, 0101, 0612, 0102, 0103, 0104, 0101, 0611, 0102, 0103, 0104, 0101, 0610, 0102, 0103, 0104, 0101, 0609, 0102, 0105</pre>
</div>
</div>
<div class="paragraph">
<p>con pÃ¡ginas de 100 bytes, podemos reducirla a:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>1, 4, 1, 6, 1, 6, 1, 6, 1, 6, 1</pre>
</div>
</div>
<div class="paragraph">
<p>Indudablemente, para determinar el nÃºmero de <strong>fallos de pÃ¡gina</strong> tambiÃ©n debemos conocer el nÃºmero de marcos disponibles para el proceso.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reemplazo_fifo"><a class="anchor" href="#_reemplazo_fifo"></a>Reemplazo FIFO</h5>
<div class="paragraph">
<p>
El <strong>algoritmo de reemplazo de pÃ¡ginas FIFO</strong> es el mÃ¡s sencillo.
Funciona de la siguiente manera:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se asocia a cada pÃ¡gina el instante de tiempo en que fue cargada por Ãºltima vez.</p>
</li>
<li>
<p>Cuando hay que hacer reemplazo se selecciona como vÃ­ctima a la pÃ¡gina mÃ¡s antigua.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Realmente no es estrictamente necesario almacenar el instante de tiempo en que una pÃ¡gina fue cargada.
En su lugar, las pÃ¡ginas en memoria pueden ser almacenadas en una cola FIFO, puesto que asÃ­ se conserva su orden de llegada en el tiempo, que es lo que nos interesa.
Esta misma cola FIFO es utilizada en algunos algoritmos que veremos posteriormente.</p>
</div>
<div class="paragraph">
<p>Vamos a ilustrar este algoritmo con un ejemplo, donde supondremos que tenemos 3 marcos de memoria fÃ­sica:</p>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">13 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Como se puede observar, las primeras 3 referencias generan <strong>fallos de pÃ¡gina</strong> porque se supone que los marcos no estÃ¡n asignados a ninguna pÃ¡gina.
A partir de ahÃ­ se utiliza el <strong>algoritmo de reemplazo FIFO</strong> para seleccionar una pÃ¡gina cuyo marco es utilizado para cargar la pÃ¡gina requerida por el proceso.</p>
</div>
<div class="paragraph">
<p>El <strong>algoritmo FIFO</strong> no siempre tiene un buen rendimiento:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Puesto que utiliza el orden en el tiempo, puede reemplazar tanto pÃ¡ginas que no estÃ¡n siendo utilizadas como pÃ¡ginas usadas frecuentemente.
Sin embargo, aunque esto pase, todo seguirÃ¡ funcionando correctamente, aunque aumentarÃ¡ la tasa de <strong>fallos de pÃ¡gina</strong> enlenteciendo el sistema.</p>
</li>
<li>
<p>No siempre que aumenta la cantidad de memoria disponible mejora el rendimiento.</p>
</li>
</ul>
</div>
<div id="fig-fallos-de-pÃ¡gina-frente-a-marcos" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/fallos_de_pÃ¡gina_frente_a_marcos.svg" alt="fallos de pÃ¡gina frente a marcos">
</div>
<div class="title">Figura 59. Fallos de pÃ¡gina frente a nÃºmero de marcos.</div>
</div>
<div class="paragraph">
<p>Es de esperar que si el nÃºmero de marcos disponibles aumenta, el nÃºmero de <strong>fallos de pÃ¡gina</strong> disminuya (vÃ©ase la <a href="memoria_virtual.html#fig-fallos-de-pÃ¡gina-frente-a-marcos">Figura 59</a>).
Sin embargo, con el <strong>algoritmo FIFO</strong> el nÃºmero de <strong>fallos de pÃ¡gina</strong> puede aumentar cuando el nÃºmero de marcos disponibles se incrementa.
Es lo que se conoce como la <strong>anormalidad de Belady</strong>.</p>
</div>
<div id="fig-anormalidad-de-belady" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/anormalidad_de_belady.svg" alt="anormalidad de belady">
</div>
<div class="title">Figura 60. Fallos de pÃ¡gina con el algoritmo de reemplazo FIFO.</div>
</div>
<div class="paragraph">
<p>Para ilustrarlo consideraremos la siguiente traza de referencias:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5</pre>
</div>
</div>
<div class="paragraph">
<p>La <a href="memoria_virtual.html#fig-anormalidad-de-belady">Figura 60</a> muestra la curva de <strong>fallos de pÃ¡gina</strong> frente el nÃºmero de marcos.
Como se puede apreciar, el nÃºmero de <strong>fallos de pÃ¡gina</strong> con cuatro marcos es superior al nÃºmero de fallos con tres marcos, aunque era de esperar que el nÃºmero de fallos de pÃ¡ginas decrementara al aumentar el nÃºmero de marcos.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reemplazo_Ã³ptimo"><a class="anchor" href="#_reemplazo_Ã³ptimo"></a>Reemplazo Ã³ptimo</h5>
<div class="paragraph">
<p>
Como resultado del descubrimiento de la <strong>anormalidad de Belady</strong> se comenzÃ³ a buscar un algoritmo de reemplazo de pÃ¡gina Ã³ptimo.
Es decir:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Que tuviera la <strong>tasa de fallo de pÃ¡gina</strong> mÃ¡s baja posible.</p>
</li>
<li>
<p>Que nunca sufra de la <strong>anormalidad de Belady</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ese algoritmo existe y consiste en reemplazar la pÃ¡gina que no va a ser utilizada en el mayor periodo de tiempo.</p>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">9 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Desafortunadamente, el <strong>algoritmo de reemplazo Ã³ptimo</strong> es difÃ­cil de implementar, puesto que necesita saber las pÃ¡ginas que serÃ¡n referenciadas en el futuro.
Por lo que solo se usa en estudios comparativos, con el fin de saber cuÃ¡nto se aproxima al Ã³ptimo un algoritmo de reemplazo determinado.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reemplazo_lru"><a class="anchor" href="#_reemplazo_lru"></a>Reemplazo LRU</h5>
<div class="paragraph">
<p>
El <strong>algoritmo de reemplazo de pÃ¡gina LRU</strong> (<em>Least Recently Used</em>) es una aproximaciÃ³n del Ã³ptimo.
La hipÃ³tesis es que si una pÃ¡gina no ha sido usada durante un gran periodo de tiempo, entonces probablemente tampoco serÃ¡ utilizada en el futuro; por lo que reemplazando la pÃ¡gina que hace mÃ¡s tiempo que no se usa, nos estarÃ­amos aproximando al algoritmo Ã³ptimo.
Vamos a ilustrarlo con un ejemplo:</p>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">11 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Este algoritmo se considera bastante eficiente cuando se aplica al reemplazo de pÃ¡ginas, por lo que es utilizado con frecuencia.</p>
</div>
<div class="paragraph">
<p>Un detalle significativo es que necesita asociar cada pÃ¡gina con el momento en que fue utilizada por Ãºltima vez.
Aunque se pueden utilizar interrupciones para implementarlo por software âmonitorizando cada acceso a la memoriaâ esta soluciÃ³n es muy ineficiente, puesto que se necesitarÃ­a actualizar algunos datos en la memoria en cada referencia a una pÃ¡gina.
Por ello el reemplazo LRU es inconcebible sin apoyo del hardware.</p>
</div>
<div class="paragraph">
<p>Son posibles dos implementaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizando contadores:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>La CPU debe tener un reloj lÃ³gico o contador que se incrementa con cada referencia a la memoria.</p>
</li>
<li>
<p>A cada pÃ¡gina se aÃ±ade un campo de <strong>instante de uso</strong>, que se almacena en la entrada de la tabla de pÃ¡ginas correspondiente.</p>
</li>
<li>
<p>Cuando una pÃ¡gina es referenciada, el valor del contador de la CPU se almacena en el campo de <strong>instante de uso</strong> de dicha pÃ¡gina.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Esta implementaciÃ³n requiere que se haga una escritura en la memoria con cada referencia.
AdemÃ¡s de una bÃºsqueda por toda la tabla de pÃ¡ginas para localizar la pÃ¡gina LRU.</p>
</div>
</li>
<li>
<p>Utilizando una pila:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Se utiliza una pila de nÃºmeros de pÃ¡gina.</p>
</li>
<li>
<p>Si se referencia una pÃ¡gina, se quita el nÃºmero correspondiente de la mitad de la pila y se inserta arriba.
Debido a esto, lo mejor es implementarla como una lista doblemente enlazada.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>La actualizaciÃ³n de la pila âque debe realizarse en cada referenciaâ tiene mayor coste que en la implementaciÃ³n anterior, pues puede ser necesario cambiar hasta 6 punteros.
Sin embargo, no es necesario realizar ninguna bÃºsqueda para seleccionar la vÃ­ctima del reemplazo, puesto que esta se puede extraer directamente del final de la pila.</p>
</li>
<li>
<p>Es una estrategia ideal para ser implementada en software o microcÃ³digo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El <strong>algoritmo reemplazo LRU</strong> pertenece a una clase denominada <strong>algoritmos de pila</strong>, que nunca se ven afectados por la <strong>anormalidad de Belady</strong>.
En estos algoritmos, las pÃ¡ginas en memoria en un instante dado para <em>N</em> marcos son un subconjunto de las que podrÃ­a haber con <em>N</em> + 1 marcos.
Concretamente, en el <strong>algoritmo LRU</strong> las pÃ¡ginas en los marcos son las <em>N</em> pÃ¡ginas mÃ¡s referenciadas recientemente.
Si el nÃºmero de marcos aumentase, estas <em>N</em> pÃ¡ginas seguirÃ¡n estando en memoria, pues siguen siendo las referenciadas mÃ¡s recientemente.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reemplazo_lru_aproximado"><a class="anchor" href="#_reemplazo_lru_aproximado"></a>Reemplazo LRU aproximado</h5>
<div class="paragraph">
<p>Pocos sistemas tienen soporte para utilizar el <strong>algoritmo de reemplazo de pÃ¡gina LRU</strong>.
Incluso en algunos casos no hay soporte de ningÃºn tipo, por lo que no queda mÃ¡s remedio que utilizar el reemplazo FIFO.</p>
</div>
<div class="paragraph">
<p>Sin embargo, muchos proporcionan algo de ayuda en la forma de un <strong>bit de referencia</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cada entrada de la tabla de pÃ¡ginas tiene un <strong>bit de referencia</strong>.</p>
</li>
<li>
<p>El hardware pone a 1 el <strong>bit de referencia</strong> cada vez que se referencia a una pÃ¡gina.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Con el <strong>bit de referencia</strong> no podemos saber con exactitud el instante, pero sÃ­ que una pÃ¡gina ha sido referenciada recientemente.
UtilizÃ¡ndolo, podemos implementar diversas aproximaciones al algoritmo LRU.</p>
</div>
<div class="sect5">
<h6 id="_reemplazo_nru"><a class="anchor" href="#_reemplazo_nru"></a>Reemplazo NRU</h6>
<div class="paragraph">
<p>
En el <strong>algoritmo de reemplazo de pÃ¡gina NRU</strong> se utiliza el <strong>bit de referencia</strong> de la siguiente manera:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>En intervalos regulares de tiempo, todos los <strong>bits de referencia</strong> son puestos a cero por el sistema operativo.</p>
</li>
<li>
<p>SegÃºn los procesos se van ejecutando, el <strong>bit de referencia</strong> asociado a cada pÃ¡gina se pone a 1 por el hardware, al ser referenciadas.</p>
</li>
<li>
<p>Cuando haya que escoger una pÃ¡gina para ser reemplazada, se intenta seleccionar una que no haya sido referenciada âes decir, con el bit de referencia a 0â.</p>
</li>
<li>
<p>En caso de que haya varias alternativas entre las que elegir se puede utilizar el <strong>algoritmo de reemplazo de pÃ¡gina FIFO</strong> o escoger un aleatoriamente.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizaremos 3 marcos de pÃ¡gina.</p>
</li>
<li>
<p>Indicaremos el valor del bit de referencia con un superÃ­ndice junto al nÃºmero de pÃ¡gina.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>No debemos olvidar que en caso de que ocurra un fallo de pÃ¡gina, despuÃ©s de la carga de la pÃ¡gina se reinicia la instrucciÃ³n que generÃ³ dicho fallo.
Por lo tanto, habrÃ¡ un acceso que pondrÃ¡ el <strong>bit de referencia a 1</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Marcaremos con una flecha el instante de tiempo en el que todos los bits de referencia se ponen a cero.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En un sistema operativo real los bits son desplazados en intervalos fijos de tiempo.
Pero esto no tiene que coincidir con una cantidad fija de referencias en la traza, puesto que hemos eliminado las referencias consecutivas a una misma pÃ¡gina.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>En caso de coincidencia, utilizaremos el <strong>reemplazo FIFO</strong> para seleccionar la vÃ­ctima.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">7</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">4</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">3</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">7</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">11 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Se puede mejorar el algoritmo anterior considerando tanto el <strong>bit de referencia</strong> como el <strong>bit de modificado</strong>, para clasificar las pÃ¡ginas en distintas categorÃ­as y escoger una pÃ¡gina en la mejor categorÃ­a.
Este es el tipo mÃ¡s comÃºn de <strong>algoritmo de reemplazo de pÃ¡gina NRU</strong>, pero lo veremos en el <a href="memoria_virtual.html#_algoritmo_de_la_segunda_oportunidad_mejorado">Apartado 17.4.1.5.4</a> bajo el nombre de <strong>Algoritmo de la segunda oportunidad mejorado</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_con_bits_de_referencia_adicionales"><a class="anchor" href="#_con_bits_de_referencia_adicionales"></a>Con bits de referencia adicionales</h6>
<div class="paragraph">
<p>Podemos obtener informaciÃ³n adicional sobre el orden en que se realizan las referencias, guardando los <strong>bits de referencia</strong> en intervalos periÃ³dicos de tiempo.
El <strong>reemplazo LRU aproximado con bits de referencia adicionales</strong>, o de <strong>envejecimiento</strong>, consiste en lo siguiente:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Aparte del <strong>bit de referencia</strong>, cada pÃ¡gina tiene un conjunto de <strong>bits de referencia adicionales</strong> âpor ejemplo, 8 bitsâ que se guardan en alguna tabla interna que mantiene el sistema operativo.</p>
</li>
<li>
<p>A intervalos regulares âpor ejemplo, cada 100 msâ el sistema operativo desplaza los <strong>bits de referencia adicionales</strong> de cada pÃ¡gina; insertando el <strong>bit de referencia</strong> de la pÃ¡gina en el bit de orden mÃ¡s alto y descartando el bit de orden mÃ¡s bajo.</p>
</li>
<li>
<p>Cuando haya que escoger una pÃ¡gina para ser reemplazada se escoge la que tenga el valor mÃ¡s pequeÃ±o en el conjunto de <strong>bits de referencia adicionales</strong>.
Esto es asÃ­, puesto que dicho conjunto contiene la historia de referencias de la pÃ¡gina.
Por ejemplo, {1 1 0 0 0 1 0 0} es mÃ¡s reciente que {0 1 1 1 0 1 1 1}.</p>
</li>
<li>
<p>Se puede utilizar el <strong>algoritmo de reemplazo de pÃ¡gina FIFO</strong> o escoger un aleatoriamente, si dos pÃ¡ginas tienen el mismo valor.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizaremos 3 marcos de pÃ¡gina.</p>
</li>
<li>
<p>Utilizaremos 2 bits adicionales.</p>
</li>
<li>
<p>Indicaremos el valor del <strong>bit de referencia</strong> y de los <strong>bits adicionales</strong> con un superÃ­ndice junto al nÃºmero de pÃ¡gina.</p>
</li>
<li>
<p>Marcaremos con una flecha el instante de tiempo en el que los bits son desplazados por el sistema operativo.</p>
</li>
<li>
<p>En caso de coincidencia, utilizaremos el <strong>reemplazo FIFO</strong> para seleccionar la vÃ­ctima.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">7</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">4</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">3</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">7</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1</p></th>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0|11</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1|11</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0|01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>0|10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1|00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1|00</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">10 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>El nÃºmero de <strong>bits adicionales</strong> puede variar de una implementaciÃ³n a otra, pero en cualquier caso debe ser seleccionado para realizar la actualizaciÃ³n lo mÃ¡s rÃ¡pidamente posible, teniendo en cuenta las caracterÃ­sticas del hardware.
En un caso extremo, el nÃºmero de <strong>bits de referencia adicionales</strong> podrÃ­a ser cero, dejando solo el <strong>bit de referencia</strong>.
A este algoritmo se lo conoce como el <strong>algoritmo de la segunda oportunidad</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_algoritmo_de_la_segunda_oportunidad"><a class="anchor" href="#_algoritmo_de_la_segunda_oportunidad"></a>Algoritmo de la segunda oportunidad</h6>
<div class="paragraph">
<p>
El <strong>algoritmo de reemplazo de la segunda oportunidad</strong> o del <strong>reloj</strong> es un <strong>algoritmo de reemplazo de pÃ¡gina FIFO</strong>, pero donde una pÃ¡gina es seleccionada considerando el <strong>bit de referencia</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Cuando es necesario seleccionar una vÃ­ctima para reemplazo se extrae una pÃ¡gina de la cola FIFO.
Esta cola contiene todas las pÃ¡ginas con marcos asignados y en el orden en que fueron cargadas, como ocurre con el <strong>algoritmo FIFO de reemplazo</strong>.</p>
</li>
<li>
<p>Si el <strong>bit de referencia</strong> estÃ¡ a 0, se utiliza esta pÃ¡gina para reemplazo.</p>
</li>
<li>
<p>Si el <strong>bit de referencia</strong> estÃ¡ a 1:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Se pone el <strong>bit de referencia</strong> a 0 y se vuelve a insertar la pÃ¡gina en el final de la cola.</p>
</li>
<li>
<p>Se extrae la siguiente pÃ¡gina del principio de la cola y se vuelve al punto 2.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>De este esquema podemos destacar algunos aspectos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Una pÃ¡gina a la que se le da la segunda oportunidad, no serÃ¡ reemplazada hasta que no se le dÃ© la segunda oportunidad a todas las demÃ¡s; siempre que no sea referenciada antes y el <strong>bit de referencia</strong> se vuelva a poner a 1.</p>
</li>
<li>
<p>En el peor de los casos, cuando todas las pÃ¡ginas tienen sus bits a uno, degenera en un reemplazo FIFO.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizaremos 3 marcos de pÃ¡gina.</p>
</li>
<li>
<p>Indicaremos el valor del <strong>bit de referencia</strong> con un superÃ­ndice junto al nÃºmero de pÃ¡gina en el marco.</p>
</li>
<li>
<p>Indicaremos el principio de la cola con una flecha junto al nÃºmero de pÃ¡gina.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>0</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">â</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â3<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>0</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â4<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">11 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_algoritmo_de_la_segunda_oportunidad_mejorado"><a class="anchor" href="#_algoritmo_de_la_segunda_oportunidad_mejorado"></a>Algoritmo de la segunda oportunidad mejorado</h6>
<div class="paragraph">
<p>Se puede mejorar el <strong>algoritmo de la segunda oportunidad</strong> considerando tanto el <strong>bit de referencia</strong> como el <strong>bit de modificado</strong>.
Algunos autores denominan a este algoritmo como <strong>algoritmo de la segunda oportunidad mejorado</strong>, mientras otro lo llaman <strong>NRU</strong>, ya que es una versiÃ³n mejorada del algoritmo del <a href="memoria_virtual.html#_reemplazo_nru">Apartado 17.4.1.5.1</a>.</p>
</div>
<div class="paragraph">
<p>Con esos dos bits, el sistema operativo clasifica las pÃ¡ginas en una de las siguientes cuatro clases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>(0,0) ni recientemente usado ni modificado. Las pÃ¡ginas de esta clase son las mejores para ser reemplazadas.</p>
</li>
<li>
<p>(0,1) no usado recientemente pero modificado. No es una buena elecciÃ³n, puesto que hay que escribir primero la pÃ¡gina al disco antes del reemplazo.</p>
</li>
<li>
<p>(1,0) recientemente usado pero no modificado.
Probablemente serÃ¡ usada de nuevo en un corto espacio de tiempo.</p>
</li>
<li>
<p>(1,1) usada y modificada.
SerÃ¡ utilizada pronto y la pÃ¡gina tendrÃ­a que ser escrita a disco para ser reemplazada.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Cuando el reemplazo de pÃ¡gina es invocado:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se examina la clase a la que pertenece cada pÃ¡gina y se reemplaza una pÃ¡gina en la clase de menor importancia que no estÃ© vacÃ­a.
Indudablemente, deberemos examinar la lista varias veces antes de encontrar la pÃ¡gina que debe ser reemplazada.</p>
</li>
<li>
<p>A intervalos regulares los <strong>bits de referencia</strong> de todas las pÃ¡ginas son puestos a cero por el sistema operativo.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En un sistema real, el sistema operativo escribe las pÃ¡ginas modificadas en el almacenamiento secundario cuando estÃ¡ desocupado y luego pone el <strong>bit de modificado</strong> a 0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizaremos 3 marcos de pÃ¡gina.</p>
</li>
<li>
<p>El que la referencia a la memoria sea para lectura <strong>R</strong> o escritura <strong>W</strong> vendrÃ¡ indicado junto al nÃºmero de pÃ¡gina en la traza.</p>
</li>
<li>
<p>Marcaremos con una flecha el instante de tiempo en el que todos los bits de referencia se ponen a cero.</p>
</li>
<li>
<p>Indicaremos el valor del <strong>bit de referencia</strong> y del <strong>bit de modificado</strong> con un superÃ­ndice junto al nÃºmero de pÃ¡gina en el marco.</p>
</li>
<li>
<p>Indicaremos el principio de la cola con una flecha junto al nÃºmero de pÃ¡gina.
Sirve para mantener un orden en las pÃ¡ginas, de tal forma que si hay varios candidatos de la misma categorÃ­a, se escoja el primero encontrado.
Si, por ejemplo, la elecciÃ³n en caso de varios candidatos es aleatoria, no hace falta ese puntero.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">â</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">7r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">4w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">3w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">2w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">7w</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">0r</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">1r</p></th>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â7<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>10</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">â</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>00</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>10</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â7<sup>11</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â1<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>01</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">â0<sup>11</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>11</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">11 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_reemplazo_basado_en_contador"><a class="anchor" href="#_reemplazo_basado_en_contador"></a>Reemplazo basado en contador</h5>
<div class="paragraph">
<p>Otros algoritmos utilizan un contador del nÃºmero de referencias que son realizadas a cada pÃ¡gina.
En esos casos, la elecciÃ³n de la vÃ­ctima se puede realizar utilizando dos esquemas: la que tiene el valor mayor o el menor.
Ninguno de los dos es muy comÃºn, ya que su implementaciÃ³n es costosa y no son una buena aproximaciÃ³n del Ã³ptimo.</p>
</div>
<div class="paragraph">
<p>Por lo general, la actualizaciÃ³n del contador no la realiza la CPU, ya que leer la entrada de la pÃ¡gina, incrementar el contador y volver a guardar la entrada, tiene un coste importante.
En su lugar:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>El contador de cada pÃ¡gina se guarda en una tabla interna.</p>
</li>
<li>
<p>PeriÃ³dicamente el sistema operativo examina el <strong>bit de referencia</strong> de cada pÃ¡gina y si estÃ¡ a 1, incrementa el contador de la pÃ¡gina correspondiente.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>El mayor problema es que permite hacer el seguimiento de la frecuencia con la que se usan las pÃ¡ginas, pero no tiene en cuenta el periodo durante el que se usan.
Por ejemplo, los procesos durante su inicializaciÃ³n pueden usar intensamente ciertas pÃ¡ginas y despuÃ©s no necesitarlas mÃ¡s.
Debido a que esas pÃ¡ginas han sido utilizadas intensamente, tiene un contador de referencias con un valor muy alto, por lo que son mantenidas en memoria aunque no vaya a ser utilizadas.</p>
</div>
<div class="paragraph">
<p>La soluciÃ³n es utilizar el <strong>algoritmo LRU aproximado con bits de referencia adicionales</strong> (vÃ©ase <a href="memoria_virtual.html#_con_bits_de_referencia_adicionales">Apartado 17.4.1.5.2</a>) porque tiene un coste muy similar a este y prioriza las usadas mÃ¡s recientemente sobre las que fueron usadas con mucha frecuencia en el pasado.</p>
</div>
<div class="sect5">
<h6 id="_reemplazo_lfu"><a class="anchor" href="#_reemplazo_lfu"></a>Reemplazo LFU</h6>
<div class="paragraph">
<p>
En el <strong>algoritmo de reemplazo de pÃ¡gina LFU</strong> (<em>Least Frequently Used</em>) o <strong>NFU</strong>  (<em>Not Frequently Used</em>) se escoge la pÃ¡gina con el contador mÃ¡s bajo.
Esto es asÃ­, puesto que suponemos que las pÃ¡ginas menos referenciadas son las que no se estÃ¡n utilizando de forma mÃ¡s activa.</p>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Indicaremos el valor de los contadores con un superÃ­ndice junto al nÃºmero de pÃ¡gina.</p>
</li>
<li>
<p>En caso de coincidencia, utilizaremos el reemplazo <strong>FIFO</strong> para seleccionar la vÃ­ctima.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>0</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>5</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>4</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>5</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>6</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>6</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>6</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>6</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>7</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>7</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">12 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_reemplazo_mfu"><a class="anchor" href="#_reemplazo_mfu"></a>Reemplazo MFU</h6>
<div class="paragraph">
<p>En el <strong>algoritmo de reemplazo de pÃ¡gina MFU</strong> (<em>Most Frequently Used</em>), se escoge la pÃ¡gina con el contador mÃ¡s alto.
Se basa en el argumento de que la pÃ¡gina con el contador mÃ¡s pequeÃ±o probablemente acaba de ser traÃ­da, por lo que aÃºn no ha sido utilizada.</p>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con un ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Indicaremos el valor de los contadores con un superÃ­ndice junto al nÃºmero de pÃ¡gina.</p>
</li>
<li>
<p>En caso de coincidencia, utilizaremos el reemplazo <strong>FIFO</strong> para seleccionar la vÃ­ctima.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch small">
<colgroup>
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
<col style="width: 5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">4</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">3</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
<th class="tableblock halign-center valign-top">2</th>
<th class="tableblock halign-center valign-top">7</th>
<th class="tableblock halign-center valign-top">0</th>
<th class="tableblock halign-center valign-top">1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>3</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">7<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>1</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0<sup>2</sup></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1<sup>1</sup></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top"><p class="tableblock">F</p></th>
</tr>
<tr>
<th class="tableblock halign-right valign-top" colspan="20"><p class="tableblock">13 fallos de pÃ¡gina</p></th>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Por extraÃ±a que parezca esta polÃ­tica, suele ser mÃ¡s eficiente que el <strong>LRU</strong> cuando se utiliza en las aplicaciones de almacenamiento de datos, porque algunas las pÃ¡ginas se utilizan intensamente durante breves periodos de tiempo, pero estÃ¡n un tiempo sin utilizarse.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_algoritmos_de_buffering_de_pÃ¡ginas"><a class="anchor" href="#_algoritmos_de_buffering_de_pÃ¡ginas"></a>17.4.2. Algoritmos de buffering de pÃ¡ginas</h4>
<div class="paragraph">
<p>
Existen otros procedimientos que pueden ser utilizados, junto con alguno de los <strong>algoritmos de reemplazo</strong> comentados, con el objetivo de mejorar su eficiencia.
Estos procedimientos se agrupan dentro de lo que se denomina <strong>algoritmos de <em>buffering</em> de pÃ¡ginas</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se puede mantener una lista de marcos libres.
Cuando se produce un <strong>fallo de pÃ¡gina</strong> se escoge un marco de la lista y se carga la pÃ¡gina, al tiempo que se selecciona una pÃ¡gina como vÃ­ctima y se copia al disco.</p>
<div class="paragraph">
<p>Esto permite que el proceso se reinicie lo antes posible, sin esperar a que la pÃ¡gina reemplazada sea escrita en el disco.
Posteriormente, cuando la escritura finalice, el marco es incluido en la lista de marcos libres.</p>
</div>
</li>
<li>
<p>Recordar quÃ© pÃ¡gina estuvo en cada marco antes de que este pasara a la lista de marcos libres, serÃ­a una mejora de lo anterior.
De esta forma las pÃ¡ginas podrÃ­an ser recuperadas directamente desde la lista, si fallara alguna antes de que su marco sea utilizado por otra pÃ¡gina.</p>
<div class="paragraph">
<p>Esto permite reducir los efectos de que el <strong>algoritmo de reemplazo</strong> escoja una vÃ­ctima equivocada.</p>
</div>
</li>
<li>
<p>Se puede mantener una lista de pÃ¡ginas modificadas y escribirlas cuando el dispositivo del espacio de intercambio no estÃ© ocupado.</p>
<div class="paragraph">
<p>Este esquema aumenta la probabilidad de que una pÃ¡gina no estÃ© marcada como modificada âcon el <strong>bit de modificado</strong>â cuando sea seleccionada por el algoritmo de reemplazo, evitando tener que hacer en ese momento la escritura en disco.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_reemplazo_local_frente_a_global"><a class="anchor" href="#_reemplazo_local_frente_a_global"></a>17.4.3. Reemplazo local frente a global</h4>
<div class="paragraph">
<p>Cuando un proceso necesita un marco, el algoritmo de reemplazo puede, tanto extraerlo de cualquier proceso, como ser obligado a considerar solo aquellas pÃ¡ginas que pertenecen al proceso que generÃ³ el fallo.
Eso permite clasificar los algoritmos de reemplazo en dos categorÃ­as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En el <strong>reemplazo local</strong> solo se pueden escoger marcos de entre los asignados al proceso.
Por tanto:</p>
<div class="ulist">
<ul>
<li>
<p>El nÃºmero de marcos asignados a un proceso no cambia porque ocurran <strong>fallos de pÃ¡gina</strong>.</p>
</li>
<li>
<p>El mayor inconveniente es que un proceso no puede hacer disponible a otros procesos los marcos de memoria que menos utiliza.</p>
</li>
</ul>
</div>
</li>
<li>
<p>En el <strong>reemplazo global</strong> se pueden escoger marcos de entre todos los del sistema, independientemente de que estÃ©n asignados a otro proceso o no.
Por tanto:</p>
<div class="ulist">
<ul>
<li>
<p>El nÃºmero de marcos asignados a un proceso puede aumentar si durante los <strong>fallos de pÃ¡gina</strong> se seleccionan marcos de otros procesos.</p>
</li>
<li>
<p>El mayor inconveniente es que los procesos no pueden controlar su <strong>tasa de fallos de pÃ¡gina</strong>, puesto que esta depende del comportamiento de los otros procesos, pudiendo afectar a su tiempo de ejecuciÃ³n de forma significativa.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generalmente, el <strong>reemplazo global</strong> proporciona mayor rendimiento, por lo que es el mÃ©todo mÃ¡s utilizado.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asignaciÃ³n_de_marcos_de_pÃ¡gina"><a class="anchor" href="#_asignaciÃ³n_de_marcos_de_pÃ¡gina"></a>17.5. AsignaciÃ³n de marcos de pÃ¡gina</h3>
<div class="paragraph">
<p>
La cuestiÃ³n que queda por resolver es cÃ³mo repartir los marcos de memoria fÃ­sica libre entre los diferentes procesos, con el fin de cubrir las necesidades de reemplazo de cada uno de ellos.
Posibles soluciones a esto serÃ­an: repartir la memoria por igual entre todos los procesos o hacerlo en proporciÃ³n a la cantidad de memoria virtual que utilizan.</p>
</div>
<div class="paragraph">
<p>Sin embargo, intuitivamente parece interesante intentar estimar de alguna manera el <strong>mÃ­nimo nÃºmero de marcos</strong> que realmente necesita cada proceso.
AsÃ­, si a cada proceso se le proporciona el nÃºmero mÃ­nimo de marcos necesario, el sistema podrÃ­a disponer de memoria libre para aumentar el nÃºmero de procesos âaumentando el uso de la CPUâ o para dedicarla a otras funciones âcomo es el caso de los bÃºferes y las cachÃ©s de E/Sâ.</p>
</div>
<div class="paragraph">
<p>El <strong>mÃ­nimo nÃºmero de marcos</strong> viene establecido por diversos factores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cuando ocurre un fallo de pÃ¡gina, la instrucciÃ³n que la ha provocado, debe ser reiniciada despuÃ©s de cargar la pÃ¡gina en un marco libre.
Por lo tanto, un proceso debe disponer de suficientes marcos como para guardar todas las pÃ¡ginas a las que una Ãºnica instrucciÃ³n pueda acceder pues, de lo contrario, el proceso nunca podrÃ­a ser reiniciado al fallar permanentemente en alguno de los accesos a memoria de la instrucciÃ³n.
Obviamente, este lÃ­mite viene establecido por la arquitectura de la mÃ¡quina.</p>
</li>
<li>
<p>Todo proceso tiene una cierta cantidad de pÃ¡ginas que en cada instante son utilizadas frecuentemente.
Si el proceso no dispone de suficientes marcos como para alojar dichas pÃ¡ginas, generarÃ¡ fallos de pÃ¡gina con demasiada frecuencia.
Esto afecta negativamente al rendimiento del sistema, por lo que es conveniente que el sistema asigne al nÃºmero de marcos necesario para que eso no ocurra.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En general, si se va reduciendo el nÃºmero de marcos asignados a un proceso, mucho antes de haber alcanzado el mÃ­nimo establecido por la arquitectura, el proceso dejarÃ¡ de ser Ãºtil debido a la elevada <strong>tasa de fallos de pÃ¡gina</strong>, que serÃ¡ mayor cuanto menos marcos tenga asignados.
Cuando eso ocurre se dice que el proceso estÃ¡ <strong>hiperpaginando</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hiperpaginaciÃ³n"><a class="anchor" href="#_hiperpaginaciÃ³n"></a>17.6. HiperpaginaciÃ³n</h3>
<div class="paragraph">
<p>
Se dice que un proceso sufre de <strong>hiperpaginaciÃ³n</strong> cuando gasta mÃ¡s tiempo paginando que ejecutÃ¡ndose.</p>
</div>
<div class="sect3">
<h4 id="_causas_de_la_hiperpaginaciÃ³n"><a class="anchor" href="#_causas_de_la_hiperpaginaciÃ³n"></a>17.6.1. Causas de la hiperpaginaciÃ³n</h4>
<div class="paragraph">
<p>En los primeros sistemas multiprogramados que implementaron la paginaciÃ³n bajo demanda, era posible que se diera el siguiente caso:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>El sistema operativo monitorizaba el uso de la CPU.
Si el uso de la misma era bajo, se cargaban nuevos procesos desde la <strong>cola de entrada</strong> para aumentar el nÃºmero de procesos ejecutÃ¡ndose al mismo tiempo âtambiÃ©n llamado <strong>grado de multiprogramaciÃ³n</strong> en esos sistemasâ.</p>
</li>
<li>
<p>Si un proceso necesitaba demasiada memoria, le podÃ­a quitar los marcos a otro, puesto que se utilizaba un <strong>algoritmo de reemplazo global</strong>.
Esto podÃ­a ocasionar que aumentara la <strong>tasa de fallos de pÃ¡gina</strong> del proceso que perdÃ­a los marcos.</p>
</li>
<li>
<p>Al aumentar los <strong>fallos de pÃ¡gina</strong> el uso de la CPU decrecÃ­a, por lo que el sistema operativo cargaba mÃ¡s procesos para aumentar el <strong>grado de multiprogramaciÃ³n</strong> y con ello el uso de la CPU.</p>
</li>
<li>
<p>Esto reducÃ­a la cantidad de memoria disponible para cada proceso, lo que aumentaba la <strong>tasa de fallos de pÃ¡ginas</strong>, que nuevamente reducÃ­a el uso de la CPU.</p>
</li>
<li>
<p>Este mecanismo iteraba hasta reducir considerablemente el rendimiento del sistema.</p>
</li>
</ol>
</div>
<div id="fig-hiperpaginaciÃ³n" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/hiperpaginaciÃ³n.svg" alt="hiperpaginaciÃ³n">
</div>
<div class="title">Figura 61. HiperpaginaciÃ³n en sistemas multiprogramados.</div>
</div>
<div class="paragraph">
<p>El fenÃ³meno comentado se ilustra en la <a href="memoria_virtual.html#fig-hiperpaginaciÃ³n">Figura 61</a>, donde se muestra el uso de la CPU frente al nÃºmero de procesos cargados en el sistema.
Cuando esto Ãºltimo aumenta, el uso de la CPU aumenta hasta alcanzar un mÃ¡ximo.
Si el <strong>grado de multiprogramaciÃ³n</strong> supera dicho punto, el sistema comienza a <strong>hiperpaginar</strong>, por lo que el uso de la CPU disminuye bruscamente.
Por lo tanto, si el sistema estÃ¡ <strong>hiperpaginando</strong>, es necesario reducir el <strong>grado de multiprogramaciÃ³n</strong> con el objetivo de liberar memoria.</p>
</div>
<div class="paragraph">
<p>En los sistemas operativos modernos ocurre algo parecido a lo descrito para los sistemas multiprogramados, aunque sin el efecto en cadena ocasionado por el intento del planificador de largo plazo de maximizar el uso de la CPU, ya que estos sistemas carecen de dicho planificador.
Sea como fuere, en ambos casos, los procesos <strong>hiperpaginan</strong> si no se les asigna un nÃºmero suficiente de marcos, haciendo que sea imposible utilizarlos.</p>
</div>
</div>
<div class="sect3">
<h4 id="_soluciones_a_la_hiperpaginaciÃ³n"><a class="anchor" href="#_soluciones_a_la_hiperpaginaciÃ³n"></a>17.6.2. Soluciones a la hiperpaginaciÃ³n</h4>
<div class="paragraph">
<p>Para el problema de la <strong>hiperpaginaciÃ³n</strong> existen diversas soluciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizar un algoritmo de reemplazo local, pues de esta manera un proceso que <strong>hiperpagina</strong> no puede afectar a otro.</p>
<div class="paragraph">
<p>Sin embargo, esto no es cierto del todo.
El uso intensivo del <strong>dispositivo de intercambio</strong> podrÃ­a afectar al rendimiento del sistema, al aumentar el <strong>tiempo de acceso efectivo</strong> al disco.</p>
</div>
</li>
<li>
<p>Proporcionar a un proceso tantos marcos como le hagan falta.
Como ya hemos comentado en diversas ocasiones, para evitar la <strong>hiperpaginaciÃ³n</strong> es necesario asignar al proceso al menos un nÃºmero mÃ­nimo de marcos, que a priori no es conocido.
Una de las estrategias que pretenden estimar dicho nÃºmero es el <strong>modelo de conjunto de trabajo</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_modelo_del_conjunto_de_trabajo"><a class="anchor" href="#_modelo_del_conjunto_de_trabajo"></a>17.6.3. Modelo del conjunto de trabajo</h4>
<div class="paragraph">
<p>
Para entender el modelo de conjunto de trabajo es necesario comenzar definiendo el <strong>modelo de localidad</strong>.
El <strong>modelo de localidad</strong> establece que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Una <strong>localidad</strong> es un conjunto de pÃ¡ginas que se utilizan juntas.</p>
</li>
<li>
<p>Cuando un proceso se ejecuta, se va moviendo de una <strong>localidad</strong> a otra.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Por ejemplo, cuando se invoca una funciÃ³n se define una nueva <strong>localidad</strong>.
En esta <strong>localidad</strong> las referencias a la memoria se realizan: al cÃ³digo de la funciÃ³n, a las variables locales de la misma y a algunas variables globales del programa.</p>
</div>
<div class="paragraph">
<p>Supongamos que proporcionamos a un proceso suficientes marcos como para alojar toda su <strong>localidad</strong> en un momento dado.
Entonces, el proceso generarÃ¡ <strong>fallos de pÃ¡gina</strong> hasta que todas las pÃ¡ginas de su <strong>localidad</strong> estÃ©n cargadas.
DespuÃ©s de eso no volverÃ¡ a fallar hasta que no cambie a una nueva <strong>localidad</strong>.
Sin embargo, si damos al proceso menos marcos de los que necesita su <strong>localidad</strong>, este <strong>hiperpaginarÃ¡</strong>.</p>
</div>
<div class="paragraph">
<p>El <strong>modelo de conjunto de trabajo</strong> es una estrategia que permite obtener una aproximaciÃ³n de la <strong>localidad</strong> del programa y consiste en lo siguiente:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Definir el parÃ¡metro <em>&#916;</em> como el tamaÃ±o de la <strong>ventana del conjunto de trabajo</strong>.</p>
</li>
<li>
<p>En un instante dado, el conjunto de pÃ¡ginas presente en las <em>&#916;</em> Ãºltimas referencias a la memoria se consideran el <strong>conjunto de trabajo</strong>.</p>
</li>
<li>
<p>Por lo tanto, el <strong>conjunto de trabajo</strong> es una aproximaciÃ³n de <strong>localidad</strong> del programa.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Por ejemplo, dada la siguiente lista de referencias a pÃ¡ginas en la memoria:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/modelo_de_conjunto_de_trabajo.svg" alt="modelo de conjunto de trabajo">
</div>
</div>
<div class="paragraph">
<p>si <em>&#916;</em> = 10 referencias a la memoria, entonces el conjunto de trabajo en <em>t</em><sub>1</sub> es {1, 2, 5, 6, 7}.
Mientras que en <em>t</em><sub>2</sub> el conjunto de trabajo es {1, 2, 3, 4}.</p>
</div>
<div class="paragraph">
<p>Obviamente, la precisiÃ³n del <strong>conjunto de trabajo</strong> como aproximaciÃ³n de la <strong>localidad</strong> del programa depende del parÃ¡metro <em>&#916;</em>.
Por ejemplo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Si <em>&#916;</em> es muy pequeÃ±a, el <strong>conjunto de trabajo</strong> no cubrirÃ­a toda la <strong>localidad</strong>.</p>
</li>
<li>
<p>Si <em>&#916;</em> es muy grande, el <strong>conjunto de trabajo</strong> se superpondrÃ­a a varias <strong>localidades</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_uso_del_conjunto_del_trabajo_para_evitar_la_hiperpaginaciÃ³n"><a class="anchor" href="#_uso_del_conjunto_del_trabajo_para_evitar_la_hiperpaginaciÃ³n"></a>17.6.4. Uso del conjunto del trabajo para evitar la hiperpaginaciÃ³n</h4>
<div class="paragraph">
<p>El uso del conjunto de trabajo es bastante sencillo:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Los diseÃ±adores del sistema seleccionan <em>&#916;</em>.</p>
</li>
<li>
<p>El sistema operativo monitoriza el <strong>conjunto de trabajo</strong> de cada proceso y le asigna tantos marcos como pÃ¡ginas haya en el <strong>conjunto de trabajo</strong>.</p>
</li>
<li>
<p>Si sobran suficientes marcos otro proceso puede ser iniciado âen el caso de los sistemas multiprogramadosâ o se puede destinar la memoria libre a otros usos.</p>
</li>
<li>
<p>Si el <strong>tamaÃ±o del conjunto de trabajo</strong> total <em>WSS</em> crece y excede el nÃºmero de marcos disponibles, el sistema podrÃ­a seleccionar un proceso para ser suspendido.
Este podrÃ¡ volver a ser reiniciado mÃ¡s tarde.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Donde el <strong>tamaÃ±o del conjunto de trabajo</strong> <em>WSS</em> es la suma del <strong>tamaÃ±o de los conjuntos de trabajo</strong> <em>WSS<sub>i</sub></em> para cada proceso <em>i</em>:</p>
</div>
<div class="stemblock">
<div class="content">
\$WSS=sum WSS_i\$
</div>
</div>
<div class="paragraph">
<p>y representa la demanda total de marcos.
Por eso, si <em>WSS</em> es mayor que el nÃºmero de marcos disponibles, habrÃ¡ <strong>hiperpaginaciÃ³n</strong>.</p>
</div>
<div class="paragraph">
<p>El sencillo algoritmo anterior permite evitar la <strong>hiperpaginaciÃ³n</strong>.
Sin embargo, el problema estÃ¡ en cÃ³mo mover la <strong>ventana del conjunto de trabajo</strong> en cada referencia, con el fin de volver a calcular el <strong>conjunto de trabajo</strong>.
Una posible aproximaciÃ³n serÃ­a utilizar un temporizador que periÃ³dicamente invocase a una funciÃ³n encargada de examinar el <strong>bit de referencia</strong> de las pÃ¡ginas en la ventana <em>&#916;</em>.
Es de suponer que las pÃ¡ginas con el <strong>bit de referencia</strong> a 1 forman parte de la <strong>localidad</strong> del programa y por tanto serÃ¡n el <strong>conjunto de trabajo</strong> a lo largo del siguiente periodo.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_otras_consideraciones"><a class="anchor" href="#_otras_consideraciones"></a>17.7. Otras consideraciones</h3>
<div class="paragraph">
<p>Ya hemos comentado que las principales decisiones que deben ser tomadas en el diseÃ±o de un sistema con <strong>paginaciÃ³n bajo demanda</strong> son la elecciÃ³n del <strong>algoritmo de reemplazo</strong> y la de la <strong>asignaciÃ³n de marcos de pÃ¡gina</strong>.
Sin embargo, hay otras consideraciones que deben ser tenidas en cuenta.</p>
</div>
<div class="sect3">
<h4 id="_prepaginado"><a class="anchor" href="#_prepaginado"></a>17.7.1. Prepaginado</h4>
<div class="paragraph">
<p>
El <strong>prepaginado</strong> es una tÃ©cnica que consiste en cargar mÃºltiples pÃ¡ginas junto con la pÃ¡gina demandada en cada <strong>fallo de pÃ¡gina</strong>.</p>
</div>
<div class="paragraph">
<p>Esas otras pÃ¡ginas se escogen especulativamente bajo la hipÃ³tesis de que van a ser necesitadas por el proceso en un corto espacio de tiempo.
De manera que si la predicciÃ³n es acertada, la <strong>tasa de fallos de pÃ¡gina</strong> se reduce significativamente.
Esta tÃ©cnica puede ser utiliza, por ejemplo, en las siguientes situaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En la <strong>paginaciÃ³n bajo demanda pura</strong>, el sistema sabe de antemano que cuando se inicia un proceso siempre fallan las primeras pÃ¡ginas de cÃ³digo, por lo que son buenas candidatas para el <strong>prepaginado</strong>.</p>
</li>
<li>
<p>En el acceso secuencial a <strong>archivos mapeados en memoria</strong>.</p>
<div class="paragraph">
<p>El sistema puede determinar que el acceso va a ser de tipo secuencial, tanto mediante el uso de tÃ©cnicas heurÃ­sticas como mediante las opciones indicadas por el proceso en la llamada al sistema con la que se abriÃ³ el archivo.</p>
</div>
<div class="paragraph">
<p>En cualquier caso, si el sistema determina que el acceso al archivo es secuencial, en cada <strong>fallo de pÃ¡gina</strong> puede cargar tanto la pÃ¡gina demanda como las siguientes, en previsiÃ³n de que vayan a ser utilizadas por el proceso.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>En general, el Ãºnico inconveniente del <strong>prepaginado</strong> es que debe ser ajustado para que el coste del mismo sea inferior al de servir los <strong>fallos de pÃ¡gina</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aplicaciones_en_modo_raw"><a class="anchor" href="#_aplicaciones_en_modo_raw"></a>17.7.2. Aplicaciones en modo RAW</h4>
<div class="paragraph">
<p>Algunas aplicaciones, cuando acceden sus datos a travÃ©s de los mecanismos de memoria virtual del sistema operativo, ofrecen peor rendimiento del que conseguirÃ­an si este mecanismo no existiera.</p>
</div>
<div class="paragraph">
<p>El ejemplo tÃ­pico, son los gestores de bases de datos, que conocen sus necesidades de memoria y disco mejor que cualquier sistema operativo de propÃ³sito general, por lo que salen beneficiadas si implementan sus propios algoritmos de gestiÃ³n de la memoria y de <em>buffering</em> de E/S.</p>
</div>
<div class="paragraph">
<p>Por eso muchos sistemas operativos modernos permiten que los programas que lo soliciten puedan acceder a los discos en <strong>modo RAW</strong>.
En el <strong>modo RAW</strong> no hay sistema de archivos, ni paginaciÃ³n bajo demanda, ni bloqueo de archivos, ni prepaginaciÃ³n, ni muchos otros servicios del sistema operativo; por lo que dichas aplicaciones deben implementar sus propios algoritmos de almacenamiento y gestiÃ³n de la memoria.</p>
</div>
<div class="paragraph">
<p>Sin embargo, hay que valorar muy bien las necesidades del programa antes de optar por este modo.
La mayor parte de las aplicaciones siempre funcionan mejor utilizando los servicios convencionales ofrecidos por el sistema operativo.</p>
</div>
</div>
<div class="sect3">
<h4 id="_tamaÃ±o_de_las_pÃ¡ginas_2"><a class="anchor" href="#_tamaÃ±o_de_las_pÃ¡ginas_2"></a>17.7.3. TamaÃ±o de las pÃ¡ginas</h4>
<div class="paragraph">
<p>Como ya comentamos al estudiar el mÃ©todo bÃ¡sico de paginaciÃ³n (vÃ©ase el <a href="paginaciÃ³n.html">CapÃ­tulo 16</a>), una decisiÃ³n de diseÃ±o importante es escoger el tamaÃ±o adecuado para las pÃ¡ginas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Con pÃ¡ginas grandes</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Se consiguen menos <strong>fallos de pÃ¡ginas</strong>.
Por ejemplo, en un caso extremo, un proceso de 100 KiB solo podrÃ­a generar un <strong>fallo de pÃ¡gina</strong> si cada pÃ¡gina es de 100 KiB, pero puede generar 102400 fallos si cada pÃ¡gina es de 1 byte.</p>
</li>
<li>
<p>Se consiguen tablas de pÃ¡ginas mÃ¡s pequeÃ±as.</p>
</li>
<li>
<p>La E/S para acceder al contenido de cada pÃ¡gina requiere menos tiempo.</p>
<div class="paragraph">
<p>En general el tiempo de transferencia es proporcional a la cantidad de informaciÃ³n transferida, lo que deberÃ­a beneficiar a los sistemas con pÃ¡ginas de pequeÃ±o tamaÃ±o.
Sin embargo, la latencia y el tiempo requerido para posicionar la cabeza lectora de los discos es muy superior al tiempo de transferencias de datos, por lo que es mÃ¡s eficiente tener menos transferencias de mayor tamaÃ±o âcomo cuando se usan pÃ¡ginas grandesâ que mÃ¡s transferencias de menor tamaÃ±o âcomo cuando se usan pÃ¡ginas pequeÃ±asâ.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Con pÃ¡ginas pequeÃ±as</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Se consigue tener menos <strong>fragmentaciÃ³n interna</strong> y, por tanto, un mejor aprovechamiento de la memoria.</p>
</li>
<li>
<p>TeÃ³ricamente, se obtiene una mejor resoluciÃ³n para asignar y transferir al disco solo la memoria que realmente necesitamos.
Esto a la larga deberÃ­a redundar en menos memoria asignada y menos operaciones de E/S.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>En la actualidad, el tamaÃ±o de pÃ¡gina mÃ¡s comÃºn es de 4 KiB en sistemas de 32 bits y 8 KiB en los de 64 bits, ya que son adecuados para la mayor parte de las aplicaciones.
Sin embargo, muchos sistemas modernos soportan el uso simultÃ¡neo de mÃºltiples tamaÃ±os de pÃ¡gina.
Esto permite que la mayor parte de las aplicaciones utilicen el tamaÃ±o estÃ¡ndar, mientras las que hacen un uso intensivo de la memoria âcomo es el caso de los gestores de bases de datosâ puedan utilizar pÃ¡ginas de mayor tamaÃ±o.</p>
</div>
</div>
<div class="sect3">
<h4 id="_efecto_de_la_estructura_de_los_programas"><a class="anchor" href="#_efecto_de_la_estructura_de_los_programas"></a>17.7.4. Efecto de la estructura de los programas</h4>
<div class="paragraph">
<p>Los programas creados considerando la <strong>localidad de referencia</strong> pueden mejorar su rendimiento en los sistemas con <strong>paginaciÃ³n bajo demanda</strong>.</p>
</div>
<div class="paragraph">
<p>Vamos a ilustrarlo con el siguiente ejemplo de un programa que inicializa a 0 un <em>array</em> de 128 por 128 elementos.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">char</span> <span class="n">data</span><span class="p">[][]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">128</span><span class="p">][</span><span class="mi">128</span><span class="p">];</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Un <em>array</em> como el indicado es almacenado en filas:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">...,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">127</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">...,</span> <span class="n">data</span><span class="p">[</span><span class="mi">127</span><span class="p">][</span><span class="mi">127</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>De manera que si suponemos que el tamaÃ±o de cada pÃ¡gina es de 128 bytes, en el mejor de los casos cada fila estarÃ¡ almacenada en una pÃ¡gina.
Por lo tanto:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Si el sistema le asigna 128 marcos o mÃ¡s, el proceso solo generarÃ¡ 128 fallos de pÃ¡gina.</p>
</li>
<li>
<p>Si el sistema operativo le asigna un solo marco, el proceso tendrÃ¡ 16&#x2009;384 fallos, aproximadamente.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sin embargo, el ejemplo serÃ­a diferente si el bucle interno del programa recorriera las columnas del <em>array</em> y no las filas:</p>
</div>
<div class="paragraph">
<p>Pues se podrÃ­an a 0 primero todos los bytes de una misma pÃ¡gina antes de empezar con la siguiente.
Esto reducirÃ­a el nÃºmero de <strong>fallos de pÃ¡gina</strong> a 128, aunque el sistema operativo solo asigne un marco al proceso.</p>
</div>
<div class="paragraph">
<p>Por lo tanto se puede concluir que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La selecciÃ³n cuidadosa de las estructuras de datos y de programaciÃ³n pueden mejorar la <strong>localidad</strong>, reduciendo la <strong>tasa de fallos de pÃ¡ginas</strong> y el tamaÃ±o del <strong>conjunto de trabajo</strong>.
Por ejemplo, las estructuras de datos tipo pila tienen buena <strong>localidad</strong>, puesto que el acceso siempre se realiza en lo alto de las mismas.
Sin embargo, las tablas de dispersiÃ³n, obviamente, estÃ¡n diseÃ±adas para dispersar las referencias, lo que produce una mala <strong>localidad</strong>.</p>
</li>
<li>
<p>La elecciÃ³n del lenguaje de programaciÃ³n tambiÃ©n puede tener efecto.
En los lenguajes como C y C&#43;&#43; se utilizan punteros con frecuencia, lo que aleatoriza el acceso a la memoria, empeorando la <strong>localidad de referencia</strong>.
AdemÃ¡s, algunos estudios indican que los lenguajes orientados a objetos tienden a tener peor <strong>localidad de referencia</strong> que los que no lo son.</p>
</li>
<li>
<p>El compilador y el cargador tambiÃ©n pueden tener un efecto importante:</p>
<div class="ulist">
<ul>
<li>
<p>Separando el cÃ³digo de los datos para permitir que las pÃ¡ginas de cÃ³digo puedan ser de solo lectura.
Esto es interesante porque las pÃ¡ginas no modificadas no tienen que ser escritas antes de ser reemplazadas.</p>
</li>
<li>
<p>El compilador puede colocar las funciones que se llaman entre sÃ­ en la misma pÃ¡gina.</p>
</li>
<li>
<p>El cargador puede situar las funciones en la memoria de tal forma que en lo posible no crucen los bordes de las pÃ¡ginas.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_interbloqueo_de_es"><a class="anchor" href="#_interbloqueo_de_es"></a>17.7.5. Interbloqueo de E/S</h4>
<div class="paragraph">
<p>Supongamos que un proceso solicita una operaciÃ³n de E/S sobre el contenido de alguna de las pÃ¡ginas de su espacio de direcciones y que, antes de que la operaciÃ³n sea realizada, la pÃ¡gina es reemplazada mientras el proceso estÃ¡ esperando.
En ese caso, la operaciÃ³n de E/S se podrÃ­a acabar realizando sobre una pÃ¡gina que pertenece a un proceso diferente.
Para evitarlo existen diversas soluciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se puede utilizar la memoria del nÃºcleo como bÃºfer en las operaciones de E/S.</p>
<div class="paragraph">
<p>En una escritura, esto obliga a la llamada al sistema a copiar los datos desde las pÃ¡ginas del proceso a la memoria del nÃºcleo, antes de solicitar la operaciÃ³n de E/S.
Mientras que en las operaciones de lectura serÃ­a justo al contrario.</p>
</div>
</li>
<li>
<p>Cada pÃ¡gina puede tener un <strong>bit de bloqueo</strong> que se utiliza para indicar quÃ© pÃ¡ginas no pueden ser seleccionadas para reemplazo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>AdemÃ¡s los <strong>bits de bloqueo</strong> se pueden utilizar en otras muchas situaciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bloquear las pÃ¡ginas del nÃºcleo para evitar que sean reemplazadas.</p>
</li>
<li>
<p>Bloquear las pÃ¡ginas que acaban de ser cargadas.</p>
<div class="paragraph">
<p>Esto evita que un <strong>fallo de pÃ¡gina</strong> en un proceso de mayor prioridad pueda reclamar el marco antes de que el proceso para el que se cargÃ³ la pÃ¡gina originalmente sea reiniciado, desperdiciando el trabajo de cargarla y provocando un nuevo <strong>fallo de pÃ¡gina</strong>.</p>
</div>
<div class="paragraph">
<p>Para implementarlo, se puede poner el <strong>bit de bloqueo</strong> a 1 cuando la pÃ¡gina se carga, volviÃ©ndolo despuÃ©s a poner a 0 cuando el proceso es planificado por primera vez, tras el <strong>fallo de pÃ¡gina</strong> que provocÃ³ la carga de la pÃ¡gina.</p>
</div>
</li>
<li>
<p>En los sistemas con <strong>tiempo real flexible</strong>, se suele permitir que las tareas de tiempo real informen de cuÃ¡les son las pÃ¡ginas mÃ¡s importantes, con el fin de que sean bloqueadas para evitar que puedan ser reemplazadas.</p>
<div class="paragraph">
<p>Para evitar riesgos, el sistema suele considerar estas solicitudes como Â«consejos de bloqueoÂ».
De esta manera el sistema es libre de descartar dichos consejos si el conjunto de marcos libres llega a ser demasiado pequeÃ±o o si un proceso pide bloquear demasiadas pÃ¡ginas.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interfaz_de_gestiÃ³n_de_la_memoria"><a class="anchor" href="#_interfaz_de_gestiÃ³n_de_la_memoria"></a>17.8. Interfaz de gestiÃ³n de la memoria</h3>
<div class="paragraph">
<p>Gracias a la abstracciÃ³n de las tÃ©cnicas de memoria virtual âcomo la paginaciÃ³n bajo demandaâ desde el punto de vista de los procesos, en cualquier sistema moderno prÃ¡cticamente solo hace falta una llamada al sistema para gestionar su espacio de direcciones virtual.</p>
</div>
<div class="paragraph">
<p>En los sistemas POSIX esta llamada es <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> y en Windows API es <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc">VirtualAlloc()</a>, que se usan junto a sus opuestas <a href="https://man7.org/linux/man-pages/man2/munmap.2.html">munmap()</a> y <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualfree">VirtualFree()</a>, respectivamente.</p>
</div>
<div class="paragraph">
<p>Ambas funciones permiten:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reservar una porciÃ³n del espacio de direcciones virtual del proceso.</p>
<div class="paragraph">
<p>La llamada solo hace la reserva de un rango de direcciones para que pueda ser utilizado por el proceso âes decir, que las pÃ¡ginas en ese rango sean vÃ¡lidasâ siendo el componente de paginaciÃ³n bajo demanda, el responsable de asignar la memoria fÃ­sica que lo respalda, cuando el proceso acceda a esas direcciones.</p>
</div>
</li>
<li>
<p>Establecer permisos âlectura, escritura y ejecuciÃ³nâ opciones de comparticiÃ³n entre procesos, bloqueo de pÃ¡ginas en la memoria fÃ­sica, pÃ¡ginas de gran tamaÃ±o y otras opciones, en la regiÃ³n de memoria virtual a reservar.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>AdemÃ¡s, en los sistemas POSIX, <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> se utiliza tambiÃ©n para mapear archivos en regiones del espacio de direcciones virtual.
Mientras que en Windows API para esa funciÃ³n se utilizan llamadas diferentes, como hemos visto.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ambas funciones ofrecen una buena cantidad de funcionalidades, pero operan a muy bajo nivel.
Por eso en ambas la pÃ¡gina es la unidad mÃ­nima en la gestiÃ³n de la memoria.
Es decir, las regiones reservadas del espacio de direcciones virtual, siempre deben comenzar en un borde de pÃ¡gina y su tamaÃ±o debe ser mÃºltiplo del tamaÃ±o de pÃ¡gina.</p>
</div>
<div class="paragraph">
<p>El problema es cÃ³mo compatibilizar eso, con las necesidades reales de los programas, que durante su ejecuciÃ³n necesitan reservar y liberar constantemente memoria para pequeÃ±os elementos, como: <em>arrays</em>, cadenas de texto, estructuras u  objetos.
Para esos casos, utilizar directamente <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> o <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc">VirtualAlloc()</a> no es una soluciÃ³n, puesto que la fragmentaciÃ³n interna conlleva un importante derroche de recursos.</p>
</div>
<div class="sect3">
<h4 id="_anatomÃ­a_del_espacio_de_direcciones_virtual_del_proceso"><a class="anchor" href="#_anatomÃ­a_del_espacio_de_direcciones_virtual_del_proceso"></a>17.8.1. AnatomÃ­a del espacio de direcciones virtual del proceso</h4>
<div class="paragraph">
<p>Los procesos pueden utilizar diversas ubicaciones dentro de su espacio de direcciones virtual para almacenar los datos que necesitan para su ejecuciÃ³n (vÃ©ase la <a href="memoria_virtual.html#fig-proceso-en-memoria-completo">Figura 62</a>):</p>
</div>
<div id="fig-proceso-en-memoria-completo" class="imageblock">
<div class="content">
<img src="media/C17-memoria_virtual/proceso_en_memoria_completo.svg" alt="proceso en memoria completo">
</div>
<div class="title">Figura 62. AnatomÃ­a de un proceso en memoria.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Las variables y constantes globales se almacenan en el <strong>segmento de datos</strong>, que tiene tamaÃ±o fijo, ya que las dimensiones de estas variables se conocen de antemano en tiempo de compilaciÃ³n, al igual que ocurre con el cÃ³digo del programa.</p>
</li>
<li>
<p>Las variables locales y los argumentos de las funciones se almacenan en la <strong>pila</strong>, junto con las direcciones de retorno para volver de las funciones.</p>
<div class="paragraph">
<p>Esta es la ubicaciÃ³n ideal para ellos, puesto que al retornar de una funciÃ³n, la pila se restablece al estado previo al que tenÃ­a cuando se invocÃ³ dicha funciÃ³n, haciendo que las variables locales y argumentos desaparezcan automÃ¡ticamente.</p>
</div>
</li>
<li>
<p>Las variables reservadas dinÃ¡micamente âpor ejemplo, usando <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a>/<a href="https://en.cppreference.com/w/c/memory/free">free()</a> en C o <a href="https://en.cppreference.com/w/cpp/language/new">new</a>/<a href="https://en.cppreference.com/w/cpp/language/delete">delete</a> en C&#43;&#43; o Javaâ se almacenan en el <strong>montÃ³n</strong>, que no es mÃ¡s una regiÃ³n contigua de memoria ubicada inmediatamente despuÃ©s del <strong>segmento de datos</strong> del proceso.</p>
</li>
<li>
<p>En la regiÃ³n entre el <strong>montÃ³n</strong> y la <strong>pila</strong> se ubican los <strong>archivos mapeados en memoria</strong>, las regiones de <strong>memoria compartida</strong>, las <strong>librerÃ­as de enlace dinÃ¡mico</strong>, las <strong>pilas</strong> de cada hilo âen procesos multihiloâ y, en general, la memoria reservada con funciones como <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> y <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc">VirtualAlloc()</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cada lenguaje de programaciÃ³n, debe proporcionar âa travÃ©s de su <strong>librerÃ­a estÃ¡ndar</strong>â un mecanismo en espacio de usuario, adecuado para la gestiÃ³n en tiempo de ejecuciÃ³n de la memoria del <strong>montÃ³n</strong> del proceso.
Para eso, cada lenguaje puede utilizar su propia implementaciÃ³n de dicho mecanismo o bien recurrir a la proporcionada por la <strong>librerÃ­a del sistema</strong>.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, en los sistemas POSIX, la <strong>librerÃ­a del sistema</strong> proporciona su propia implementaciÃ³n, accesible a travÃ©s de las funciones <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a>, que es utilizada directamente por los programas escritos en C.
Esta implementaciÃ³n hace uso de <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a>, pero ofrece mayor control sobre la cantidad de memoria que podemos reservar, como veremos en el <a href="memoria_virtual.html#_gestiÃ³n_de_la_memoria_del_montÃ³n">Apartado 17.8.2</a>.</p>
</div>
<div class="paragraph">
<p>Otros lenguajes de programaciÃ³n tienen otras interfaces para gestionar la memoria, pero utilizan internamente las funciones <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a> de la <strong>librerÃ­a del sistema</strong>.
Sin embargo, este no es el caso ni de C&#43;&#43; ni de Java ni de algunos otros lenguajes.
En C&#43;&#43;, los operadores <a href="https://en.cppreference.com/w/cpp/language/new">new</a> y <a href="https://en.cppreference.com/w/cpp/language/delete">delete</a> utilizan sus propios algoritmos de gestiÃ³n de la memoria del <strong>montÃ³n</strong>, mÃ¡s optimizados que <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a> para la creaciÃ³n y destrucciÃ³n de objetos de cualquier tamaÃ±o de manera eficiente.</p>
</div>
<div class="paragraph">
<p>En Windows API ocurre algo similar.
La <strong>librerÃ­a del sistema</strong> proporciona su propia gestiÃ³n de la memoria del <strong>montÃ³n</strong>, que es accesible para cualquier programa a travÃ©s de las funciones <a href="https://docs.microsoft.com/en-us/windows/win32/api/heapapi/nf-heapapi-heapalloc">HeapAlloc()</a> y <a href="https://docs.microsoft.com/en-us/windows/win32/api/heapapi/nf-heapapi-heapfree">HeapFree()</a>, y que se implementa sobre <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc">VirtualAlloc()</a>.
La <strong>librerÃ­a estÃ¡ndar</strong> de C utiliza, a su vez, esas funciones para implementar <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a>.
Lo mismo ocurre en otros lenguajes, aunque no en todos, ya que algunos optan por implementar algoritmos mÃ¡s eficientes para sus casos de uso directamente sobre <a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc">VirtualAlloc()</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_gestiÃ³n_de_la_memoria_del_montÃ³n"><a class="anchor" href="#_gestiÃ³n_de_la_memoria_del_montÃ³n"></a>17.8.2. GestiÃ³n de la memoria del montÃ³n</h4>
<div class="paragraph">
<p>Para ilustrar cÃ³mo se puede gestionar la memoria del <strong>montÃ³n</strong> utilizaremos como ejemplo el mecanismo empleado por la <strong>librerÃ­a del sistema</strong> de los sistemas POSIX âaccesible a travÃ©s de las funciones <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a>.
Sin embargo, es importante tener en cuenta que esta tarea se realiza de manera muy similar en las implementaciones de otros sistemas operativos y lenguajes de programaciÃ³n.</p>
</div>
<div class="paragraph">
<p>El funcionamiento bÃ¡sico de <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> sigue las siguientes reglas:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Cuando la memoria solicitada supera cierto umbral â128 KiB en sistemas GNU/Linuxâ es reservada directamente mediante la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a>.
Eso significa que las peticiones de gran tamaÃ±o realmente no consumen espacio del <strong>montÃ³n</strong>, si no que se reservan del hueco entre el <strong>montÃ³n</strong> y la <strong>pila</strong>.</p>
</li>
<li>
<p>Cuando un proceso hace una peticiÃ³n de memoria dinÃ¡mica espera que el espacio ofrecido sea continuo en el espacio de direcciones virtual, por lo que la memoria del <strong>montÃ³n</strong> se gestiona usando un algoritmo de <strong>asignaciÃ³n contigua de memoria</strong> (vÃ©ase <a href="memoria_principal.html#_asignaciÃ³n_contigua_de_memoria">Apartado 15.5</a>) y, puesto que las peticiones pueden ser de tamaÃ±o variable, se utiliza con un esquema de <strong>particionado dinÃ¡mico</strong>.</p>
<div class="paragraph">
<p>Es decir, que para las peticiones que no entran en el caso anterior, se busca en la tabla de huecos libres y ocupados del <strong>montÃ³n</strong> uno lo suficientemente como grande para atender la peticiÃ³n.
Se asigna el espacio solicitado y el resto sigue marcado como hueco libre.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>La estrategia mÃ¡s comÃºn de bÃºsqueda es el <strong>mejor ajuste</strong>, utilizando algÃºn tipo de estructura de datos que mantenga los huecos libres ordenados por tamaÃ±o, para encontrar el de tamaÃ±o adecuado rÃ¡pidamente.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Si no hay suficiente memoria libre contigua como para atender la peticiÃ³n, se utiliza la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a>, para extender el tamaÃ±o del <strong>montÃ³n</strong> reservando una nueva regiÃ³n separada âa veces llamada <strong>arena</strong>â y comenzar a repartirla.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En aplicaciones pequeÃ±as, algunas implementaciones intentan ampliar primero el espacio libre utilizando la llamada al sistema <a href="https://man7.org/linux/man-pages/man2/brk.2.html">brk()</a>, que sirve para extender el <strong>montÃ³n</strong> sobre la regiÃ³n adyacente no asignada del espacio de direcciones virtual del proceso.
Este es el caso de la implementaciÃ³n estÃ¡ndar de <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> en GNU/Linux.</p>
</div>
<div class="paragraph">
<p>La llamada al sistema <a href="https://man7.org/linux/man-pages/man2/brk.2.html">brk()</a> ha sido eliminada del estÃ¡ndar POSIX, pero algunos sistemas la mantienen por compatibilidad hacia atrÃ¡s, dado que era la forma en la que tradicionalmente se ampliaba la memoria del <strong>montÃ³n</strong> en los primeros UNIX.
En macOS esta llamada se emula con una regiÃ³n de 4 MiB reservada con <strong>mmap</strong> la primera vez que se utiliza.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_fragmentaciÃ³n_2"><a class="anchor" href="#_fragmentaciÃ³n_2"></a>17.8.3. FragmentaciÃ³n</h4>
<div class="paragraph">
<p>La estrategia comentada sufre de <strong>fragmentaciÃ³n interna</strong>.
En las peticiones grandes, <a href="https://man7.org/linux/man-pages/man2/mmap.2.html">mmap()</a> reserva en mÃºltiplos de tamaÃ±o de pÃ¡gina, por lo que siempre se puede perder cierta cantidad, aunque pequeÃ±a en comparaciÃ³n al tamaÃ±o de la regiÃ³n reservada.
En las peticiones pequeÃ±as, la memoria se asigna en mÃºltiplos de una unidad mÃ­nima âpor ejemplo, 16 o 32 bytesâ por lo que tambiÃ©n se puede perder cierta cantidad de memoria.</p>
</div>
<div class="paragraph">
<p>AdemÃ¡s sufre de <strong>fragmentaciÃ³n externa</strong>, porque despuÃ©s de que el proceso lleva un tiempo en ejecuciÃ³n, liberando y reservando memoria, el espacio puede comenzar a quedar fraccionado en un gran nÃºmero de pequeÃ±os huecos, obligando a la librerÃ­a a buscar mÃ¡s espacio para el <strong>montÃ³n</strong>, aunque en suma haya suficiente espacio en los huecos libres.</p>
</div>
<div class="paragraph">
<p>Esto representa un reto para los desarrolladores de aplicaciones, que previsiblemente vayan a ejecutarse durante periodos muy largos de tiempo.
En esos casos, es comÃºn optar por librerÃ­as externas, que implementen gestores de memoria que fragmenten menos la memoria, o soluciones basadas en alguna forma de referencias indirectas y recolecciÃ³n de basura, para ocasionalmente poder compactar la memoria del <strong>montÃ³n</strong>.
Esto Ãºltimo, es lo que hace la mÃ¡quina virtual de Java.</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>âÂ Anterior:Â <a href="paginaciÃ³n.html">PaginaciÃ³n</a>Â | âÂ Subir:Â <a href="gestiÃ³n_de_la_memoria.html">GestiÃ³n de la memoria</a>Â | âÂ Inicio:Â <a href="main.html">Sistemas Operativos</a>Â | Siguiente:Â <a href="gestiÃ³n_del_almacenamiento.html">GestiÃ³n del almacenamiento</a>Â â</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<div id="footer">
    <div id="footer-text">
        Esta obra estÃ¡ sujeta a la licencia
        <a href="http://creativecommons.org/licenses/by/4.0/deed.es">Creative Commons AtribuciÃ³n 4.0 Internacional</a>,
        excepto donde se indique lo contrario.
    </div>
</div>
</body>
</html>