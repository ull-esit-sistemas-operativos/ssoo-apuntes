<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="JesÃºs Torres">
<title>Sistemas Operativos</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<meta name='robots' content='noindex,nofollow'>
<link rel="icon" href="media/extras/favicon.ico" sizes="any">
<link rel="icon" href="media/extras/ssoo-icon.svg" type="image/svg+xml">
<link rel="icon" type="image/png" sizes="192x192" href="media/extras/ssoo-icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="media/extras/ssoo-icon-512.png">
<link rel="apple-touch-icon" href="media/extras/ssoo-apple-touch-icon.png"><!-- 180Ã180 -->
<link rel="stylesheet" href="media/extras/inlineDisqussions.css">
<style>
    body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    content {
        flex: 1;
    }
    #preamble {
        margin-top: 0.5em;
    }
    #header, #content, #footnotes {
        margin: 0 auto 0 5em
    }
    #content h1>a.anchor, h2>a.anchor, h3>a.anchor,
    #toctitle>a.anchor, .sidebarblock>.content>.title>a.anchor,
    h4>a.anchor, h5>a.anchor, h6>a.anchor {
        color: #ba3925;
    }
    .imageblock {
        text-align: center;
    }
    .imageblock > .content {
        margin-bottom: 1rem;
    }
    .imageblock > .title {
        text-align: inherit;
    }
    .tableblock > .lightcell {
        color: gray;
    }
    table tfoot td p {
        font-weight: bold;
    }
    #footer-text {
        margin: 0 auto;
        max-width: 62.5em;
        padding-left: .9375em;
        padding-right: .9375em;
    }
    #footer-text a {
        color: hsla(0,0%,100%,.8);
        text-decoration: none;
        font-weight: bold;
    }
    #footer-text a:hover {
        color: hsla(0,0%,100%,.8);
    }
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="media/extras/inlineDisqussions.js"></script>
<script type="text/javascript">
    window.onload = function(){
        if ('true' === 'true') {
            setTimeout(function() {
                disqus_shortname = 'ull-esit-sistemas-operativos';
                jQuery(document).ready(function() {
                    jQuery("img, p, .colist td, .stemblock").not('#toc p').inlineDisqussions();
                });
            }, 500);
        }
    }
</script>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
<style>
.admonitionblock td.icon .icon-time:before {content:"\f017";color:#f28500;}
</style>
</head>
<body id="memoria_principal" class="book toc2 toc-left">
<div id="header">
<h1>Sistemas Operativos</h1>
<div class="details">
<span id="author" class="author">JesÃºs Torres</span><br>
<span id="email" class="email"><a href="mailto:jmtorres@ull.es">jmtorres@ull.es</a></span><br>
<span id="revdate">Curso 2021-2022</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Tabla de Contenido</div>
<p><span class="toc-root"><a href="main.html">Sistemas Operativos</a></span></p><ul class="sectlevel1">
<li><a href="ediciones_y_licencia.html">Ediciones y licencia</a>
</li>
<li><a href="cÃ³digo_de_los_ejemplos.html">CÃ³digo de los ejemplos</a>
</li>
<li><a href="introducciÃ³n.html">Parte I: IntroducciÃ³n</a>
</li>
<li><a href="organizaciÃ³n_de_los_sistemas_operativos.html">Parte II: OrganizaciÃ³n de los sistemas operativos</a>
</li>
<li><a href="gestiÃ³n_de_procesos.html">Parte III: GestiÃ³n de procesos</a>
</li>
<li><a href="gestiÃ³n_de_la_memoria.html">Parte IV: GestiÃ³n de la memoria</a>
<ul class="sectlevel1">
<li><a href="memoria_principal.html"><span class="toc-current">15. Memoria principal</span></a>
<ul class="sectlevel2">
<li><a href="memoria_principal.html#_etapas_de_un_programa_de_usuario">15.1. Etapas de un programa de usuario</a>
</li>
<li><a href="memoria_principal.html#_reubicaciÃ³n_de_las_direcciones">15.2. ReubicaciÃ³n de las direcciones</a>
</li>
<li><a href="memoria_principal.html#_espacio_de_direcciones_virtual_frente_a_fÃ­sico">15.3. Espacio de direcciones virtual frente a fÃ­sico</a>
</li>
<li><a href="memoria_principal.html#_enlazado_dinÃ¡mico_y_librerÃ­as_compartidas">15.4. Enlazado dinÃ¡mico y librerÃ­as compartidas</a>
</li>
<li><a href="memoria_principal.html#_asignaciÃ³n_contigua_de_memoria">15.5. AsignaciÃ³n contigua de memoria</a>
</li>
<li><a href="memoria_principal.html#_fragmentaciÃ³n">15.6. FragmentaciÃ³n</a>
</li>
<li><a href="memoria_principal.html#_intercambio">15.7. Intercambio</a>
</li>
</ul>
</li>
<li><a href="paginaciÃ³n.html">16. PaginaciÃ³n</a>
</li>
<li><a href="memoria_virtual.html">17. Memoria virtual</a>
</li>
</ul>
</li>
<li><a href="gestiÃ³n_del_almacenamiento.html">Parte V: GestiÃ³n del almacenamiento</a>
</li>
<li><a href="bibliografÃ­a.html">BibliografÃ­a</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="memoria_principal"><a class="anchor" href="#memoria_principal"></a>15. Memoria principal</h2>
<div class="sectionbody">
<div class="admonitionblock time">
<table>
<tr>
<td class="icon">
<i class="fa icon-time" title=""></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Tiempo de lectura:</strong> 31 minutos</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>La memoria es un recurso central para el funcionamiento de un sistema operativo moderno, puesto que es el Ãºnico medio de almacenamiento al que la CPU puede acceder directamente.
Por ello, para que un programa pueda ser ejecutado, debe ser cargado en la memoria desde el disco y creadas o modificadas las estructuras internas del sistema operativo necesarias para convertirlo en un proceso.
AdemÃ¡s, dependiendo de la forma en la que se gestiona la memoria, los procesos âo partes de los mismosâ pueden moverse de la memoria al disco ây viceversaâ durante su ejecuciÃ³n, con el objetivo de ajustar las necesidades de memoria para mantener el <strong>uso de la CPU</strong> lo mÃ¡s alto posible.</p>
</div>
<div class="paragraph">
<p>Como comentamos en el <a href="tipos_de_sistemas_operativos.html#_sistemas_multiprogramados">Apartado 2.1.2</a>, en los <strong>sistemas multiprogramados</strong> existe una <strong>cola de entrada</strong>, que se define como aquella formada por el conjunto de procesos en disco que esperan para ser cargados en la memoria para su ejecuciÃ³n.</p>
</div>
<div class="paragraph">
<p>Por tanto, el procedimiento normal de ejecuciÃ³n de un programa en dichos sistemas es:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Seleccionar un proceso de la cola de entrada y cargarlo en la memoria.</p>
</li>
<li>
<p>Mientras el proceso se ejecuta, este accede a instrucciones y datos de la memoria.</p>
</li>
<li>
<p>Finalmente, el proceso termina y su espacio en memoria es marcado como disponible.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>En los sistemas de propÃ³sito general modernos âdesde los <strong>sistemas de tiempo compartido</strong> y los primeros <strong>sistemas de escritorio</strong>â no existe <strong>cola de entrada</strong>, por lo que los programas se cargan inmediatamente en memoria cuando los usuarios solicitan su ejecuciÃ³n.
Excepto por eso, el procedimiento normal de ejecuciÃ³n de un programa es similar al de los <strong>sistemas multiprogramados</strong>.</p>
</div>
<div class="sect2">
<h3 id="_etapas_de_un_programa_de_usuario"><a class="anchor" href="#_etapas_de_un_programa_de_usuario"></a>15.1. Etapas de un programa de usuario</h3>
<div class="paragraph">
<p>En la mayor parte de los casos, un programa de usuario debe pasar por diferentes etapas âalgunas de las cuales son opcionalesâ antes de ser ejecutado (vÃ©ase la <a href="memoria_principal.html#fig-etapas-programas-de-usuario">Figura 48</a>).</p>
</div>
<div id="fig-etapas-programas-de-usuario" class="imageblock">
<div class="content">
<img src="media/C15-memoria_principal/etapas_de_un_programa_de_usuario.svg" alt="etapas de un programa de usuario">
</div>
<div class="title">Figura 48. Etapas de procesamiento de un programa de usuario.</div>
</div>
<div class="paragraph">
<p>Los archivos de <strong>cÃ³digo fuente</strong> del programa son compilados por el compilador, generando un archivo de <a href="https://es.wikipedia.org/wiki/C%C3%B3digo_objeto"><strong>cÃ³digo objeto</strong></a> âcon extensiones <code>.o</code> u <code>.obj</code>â para cada uno.</p>
</div>
<div class="paragraph">
<p>Todos los archivos de <strong>cÃ³digo objeto</strong> son unidos por el enlazador para crear el archivo <strong>ejecutable</strong>, en una fase que se denomina <strong>enlazado estÃ¡tico</strong>.
En esta fase tambiÃ©n se pueden incorporar al ejecutable <strong>librerÃ­as de enlace estÃ¡tico</strong> âcon extensiones <code>.a</code> o <code>.lib</code>â con <strong>cÃ³digo objeto</strong> que ha sido empaquetado para ser reutilizado en mÃºltiples ejecutables.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>El compilador y el enlazador suelen ser dos programas independientes, aunque en ocasiones el compilador se haga cargo de ambas fases por comodidad.
Por ejemplo, en los sistemas GNU el compilador <a href="https://es.wikipedia.org/wiki/GNU_Compiler_Collection">gcc</a> por defecto genera el <strong>cÃ³digo objeto</strong> en archivos temporales, luego invoca al enlazador <a href="https://en.wikipedia.org/wiki/Linker_(computing)">ld</a> para crear el <strong>ejecutable</strong> y finalmente elimina los archivos temporales.</p>
</div>
<div class="paragraph">
<p>En proyectos grandes suele ser mÃ¡s interesante usar ambas herramientas por separado para reducir el tiempo de compilaciÃ³n.
El compilador genera los archivos de <strong>cÃ³digo objeto</strong>, que se conservan entre compilaciones.
AsÃ­, cada vez que se quiere generar una nueva versiÃ³n del ejecutable, solo es necesario compilar los archivos de <strong>cÃ³digo fuente</strong> que hayan cambiado y luego enlazar juntos todos los archivos de <strong>cÃ³digo objeto</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Al crear el <strong>ejecutable</strong> se pueden guardar en Ã©l dependencias respecto a librerÃ­as que se enlazarÃ¡n posteriormente, durante la carga o ejecuciÃ³n del programa, en una fase denominada <strong>enlazado dinÃ¡mico</strong>.</p>
</div>
<div class="paragraph">
<p>En el momento en el que se va a ejecutar el programa, cuando estÃ¡ construyendo la imagen binaria del proceso en la memoria; el sistema operativo examina estas dependencias, carga las <strong>librerÃ­as de enlace dinÃ¡mico</strong> indicadas âcon extensiones <code>.so</code>, <code>dylib</code> o <code>.dll</code>â y resuelve las referencias del programa sus variables y funciones.
Las <strong>librerÃ­as de enlace dinÃ¡mico</strong> contienen <strong>cÃ³digo objeto</strong>, enlazado en un formato especial de <strong>ejecutable</strong> diseÃ±ado para contener partes compartidas entre archivos ejecutables.</p>
</div>
<div class="paragraph">
<p>Este proceso puede ocurrir mientras se carga el <strong>ejecutable</strong> âcomo se ha descritoâ o cuando el programa usa por primera vez un elemento de las <strong>librerÃ­as de enlace dinÃ¡mico</strong>.
TambiÃ©n es comÃºn que el sistema ofrezca funciones para que los programas puedan cargar manualmente e invocar funciones de <strong>librerÃ­as de enlace dinÃ¡mico</strong>.
Esto es muy Ãºtil para crear programas que se puedan mejorar por medio de extensiones o <em>plugins</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Tabla 13. Extensiones de archivos de programas.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">UNIX, Linux y otros sistemas estilo UNIX</th>
<th class="tableblock halign-left valign-top">macOS</th>
<th class="tableblock halign-left valign-top">Microsoft Windows</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">CÃ³digo objeto</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.o</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.o</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.obj</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">LibrerÃ­a de enlace estÃ¡tico</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.a</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.lib</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Ejecutable</p></th>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.exe</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">LibrerÃ­a de enlace dinÃ¡mico</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.so</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.so</code>, <code>.dylib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.dll</code></p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Formato de ejecutables y librerÃ­as de enlace dinÃ¡mico</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://es.wikipedia.org/wiki/Executable_and_Linkable_Format">Executable and Linkable Format</a> (ELF)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/Mach-O">Mach-O</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://es.wikipedia.org/wiki/Portable_Executable">Portable Executable</a> (PE)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_reubicaciÃ³n_de_las_direcciones"><a class="anchor" href="#_reubicaciÃ³n_de_las_direcciones"></a>15.2. ReubicaciÃ³n de las direcciones</h3>
<div class="paragraph">
<p>La mayor parte de los sistemas permiten que un proceso de usuario resida en cualquier parte de la memoria fÃ­sica.
AsÃ­, aunque el espacio de direcciones del sistema comience en <code>0x00000000</code>, la primera direcciÃ³n del proceso de usuario no tiene por quÃ© ser esa.</p>
</div>
<div class="paragraph">
<p>En cada una de las etapas vistas en el <a href="memoria_principal.html#_etapas_de_un_programa_de_usuario">Apartado 15.1</a> las direcciones pueden representarse de formas distintas, por lo que en cada paso es necesario reasignar las direcciones usadas en una etapa en direcciones de la siguiente.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, en el cÃ³digo fuente de un programa las direcciones son generalmente simbÃ³licas, como los nombres de las variables y las funciones.
A continuaciÃ³n, un compilador suele reasignar esas direcciones simbÃ³licas en <strong>direcciones reubicables</strong> del estilo de Â«120 bytes desde el comienzo del mÃ³duloÂ».
Finalmente âel enlazadorâ que genera el ejecutableâ o el cargador âque carga el programa en la memoriaâ convierte esas <strong>direcciones reubicables</strong> en <strong>direcciones absolutas</strong>, como <code>0x00210243</code>.</p>
</div>
<div class="paragraph">
<p>Por tanto, en cada etapa se traducen las direcciones de un espacio de direcciones en el siguiente.
Sin embargo, para que al final el programa pueda ser ejecutado, es necesario que tanto a los datos como a las instrucciones se les reasignen en algÃºn momento a <strong>direcciones absolutas</strong> de la memoria.
Esto puede ocurrir en <strong>tiempo de compilaciÃ³n</strong>, <strong>tiempo de carga</strong> o <strong>tiempo de ejecuciÃ³n</strong></p>
</div>
<div class="sect3">
<h4 id="_reubicaciÃ³n_en_tiempo_de_compilaciÃ³n"><a class="anchor" href="#_reubicaciÃ³n_en_tiempo_de_compilaciÃ³n"></a>15.2.1. ReubicaciÃ³n en tiempo de compilaciÃ³n</h4>
<div class="paragraph">
<p>Si durante la compilaciÃ³n o el enlazado se conoce el lugar de la memoria donde va a ser ejecutado el proceso, se puede generar directamente cÃ³digo con <strong>direcciones absolutas</strong> o <strong>cÃ³digo absoluto</strong>.</p>
</div>
<div class="paragraph">
<p>Eso significa que si en algÃºn momento la direcciÃ³n de inicio donde es cargado el programa cambia, es necesario recompilar el cÃ³digo fuente del programa para poder ejecutarlo en la nueva ubicaciÃ³n.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Un ejemplo son los ejecutables con formato <a href="https://es.wikipedia.org/wiki/Archivo_COM">COM</a> del sistema operativo MS-DOS.
Estos ejecutables no eran reubicables, aunque podÃ­an ponerse en distintas ubicaciones de la memoria gracias a la <a href="https://es.wikipedia.org/wiki/Segmentaci%C3%B3n_de_memoria_del_x86">segmentaciÃ³n de memoria de la familia Intel x86</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_reubicaciÃ³n_en_tiempo_de_carga"><a class="anchor" href="#_reubicaciÃ³n_en_tiempo_de_carga"></a>15.2.2. ReubicaciÃ³n en tiempo de carga</h4>
<div class="paragraph">
<p>Si no se conoce durante la compilaciÃ³n el lugar donde va a residir un programa cuando sea ejecutado, el compilador y el enlazador deben generar ejecutables con <strong>cÃ³digo reubicable</strong>.</p>
</div>
<div class="paragraph">
<p>En este tipo de cÃ³digo se utilizan <strong>direcciones reubicables</strong>, de manera que se retrasa su asignaciÃ³n a <strong>direcciones absolutas</strong> hasta el momento de la carga del programa.
Esto permite que un programa pueda residir en cualquier parte de la memoria fÃ­sica, cargando los procesos donde mÃ¡s convenga para maximizar el aprovechamiento de la misma.</p>
</div>
<div class="paragraph">
<p>Para generar <strong>cÃ³digo reubicable</strong>, por lo general, el compilador genera
<strong>cÃ³digo independiente de la posiciÃ³n</strong> o <strong>PIC</strong> (<em>Position-Independent Code</em>).
Este tipo de cÃ³digo se puede ejecutar adecuadamente y sin modificaciones independientemente del lugar de la memoria donde estÃ© ubicado, porque utiliza direcciones relativas.</p>
</div>
<div class="paragraph">
<p>Lamentablemente, esto puede limitar las caracterÃ­sticas de la CPU que puede utilizar el compilador o, a veces, las instrucciones que usan direcciones absolutas son mÃ¡s rÃ¡pidas que las que usan direcciones relativas, aunque en los procesadores modernos la diferencia apenas es perceptible.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, las CPU x86-64 soportan un modo de direccionamiento en el que las direcciones son relativas a la direcciÃ³n en el contador de programa.
Esto simplifica generar cÃ³digo reubicable eficiente.
Sin embargo, en las CPU x86 anteriores, las instrucciones de salto podÃ­an ser relativas al contador de programa, pero no ocurrÃ­a asÃ­ con aquellas destinadas a acceder a los datos del programa.</p>
</div>
<div class="paragraph">
<p>Cuando no se puede o no es eficiente generar <strong>cÃ³digo independiente de la posiciÃ³n</strong> se puede recurrir al uso de <strong>tablas de reubicaciÃ³n</strong> en tiempo de carga.
En este caso el compilador y el enlazador generan:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>CÃ³digo con direcciones relativas a cierta direcciÃ³n fija del ejecutable âcomo el comienzo de la secciÃ³n de cÃ³digoâ o direcciones absolutas calculadas bajo la suposiciÃ³n de que el ejecutable se va a poder cargar en cierta direcciÃ³n concreta de la memoria, que suele guardarse en la cabecera del ejecutable.</p>
</li>
<li>
<p>Una <strong>tabla de reubicaciones</strong> que se almacena en el mismo ejecutable.
Esta tabla contiene punteros a las ubicaciones en el cÃ³digo del ejecutable de las direcciones que deben reubicarse al cargarlo.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Durante la carga, el cargador del sistema operativo, una vez ha copiado a la memoria el contenido del ejecutable y conoce la ubicaciÃ³n definitiva del programa, recorre la <strong>tabla de reubicaciones</strong> para buscar las <strong>direcciones reubicables</strong> y actualizarlas.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Direcciones en el cÃ³digo objeto en Linux x86-64</div>
<div class="paragraph">
<p>Supongamos que en un sistema Linux x86-64 tenemos el siguiente cÃ³digo en un archivo de nombre <code>test.c</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">test</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">test</span><span class="p">();</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En lugar de compilarlo para generar el ejecutable final, podemos usar la opciÃ³n <code>-c</code> del compilador <a href="https://es.wikipedia.org/wiki/GNU_Compiler_Collection">gcc</a> para que solo genere el archivo de <strong>cÃ³digo objeto</strong> correspondiente.
DespuÃ©s podemos usar el comando <a href="https://man7.org/linux/man-pages/man1/objdump.1.html">objdump</a> para examinar el <strong>cÃ³digo objeto</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gcc -c test.c
$ objdump -d test.o

test.o:     file format elf64-x86-64


Disassembly of section .text:

0000000000000000 &lt;test&gt;:                                <i class="conum" data-value="1"></i><b>(1)</b>
   0:   f3 0f 1e fa             endbr64
   4:   55                      push   %rbp
   5:   48 89 e5                mov    %rsp,%rbp
   8:   48 c7 05 00 00 00 00    movq   $0xc,0x0(%rip)   <i class="conum" data-value="3"></i><b>(3)</b>
   f:   0c 00 00 00
  13:   b8 00 00 00 00          mov    $0x0,%eax
  18:   5d                      pop    %rbp
  19:   c3                      retq

000000000000001a &lt;main&gt;:                                <i class="conum" data-value="1"></i><b>(1)</b>
  1a:   f3 0f 1e fa             endbr64
  1e:   55                      push   %rbp
  1f:   48 89 e5                mov    %rsp,%rbp
  22:   48 c7 05 00 00 00 00    movq   $0xb,0x0(%rip)   <i class="conum" data-value="3"></i><b>(3)</b>
  29:   0b 00 00 00
  2d:   b8 00 00 00 00          mov    $0x0,%eax
  32:   e8 00 00 00 00          callq  37 &lt;main+0x1d&gt;   <i class="conum" data-value="2"></i><b>(2)</b>
  37:   5d                      pop    %rbp
  38:   c3                      retq</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>El archivo de <strong>cÃ³digo objeto</strong> se divide en varias secciones o segmentos.
En el <strong>segmento de cÃ³digo</strong> o <strong>.text</strong> se almacenan las funciones compiladas del cÃ³digo original.
Cada funciÃ³n tiene una ubicaciÃ³n, que es relativa a su posiciÃ³n dentro del segmento de cÃ³digo en el archivo.
<div class="paragraph">
<p>Obviamente, estas no son las direcciones definitivas en las que se ejecutarÃ¡n estas funciones cuando el ejecutable sea cargado en la memoria, por lo que este <strong>cÃ³digo objeto</strong> generado por el compilador debe ser <strong>cÃ³digo reubicable</strong>.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>callq</code> es la instrucciÃ³n encargada de invocar a <code>test()</code> desde <code>main()</code>, pero si ejecutamos este cÃ³digo en su estado actual, la ejecuciÃ³n saltarÃ­a a la instrucciÃ³n en 0x37, es decir, a la siguiente tras <code>callq</code>.
Esto no es un error del compilador, sino que el compilador no ha puesto la direcciÃ³n correcta porque aÃºn desconoce cuÃ¡l serÃ¡ la ubicaciÃ³n definitiva de <code>test()</code>.
<div class="paragraph">
<p>En x86-64 las instrucciones de salto como <code>callq</code> hacen saltos relativos al contador de programa âalmacenado en un registro llamando <code>rip</code>â.
Todas estas instrucciones llevan un desplazamiento que se suma al valor actual de <code>rip</code>, que contiene la direcciÃ³n en la memoria de la siguiente instrucciÃ³n.
Como el compilador no sabe donde estarÃ¡ <code>test()</code>, deja este desplazamiento a 0 âpor eso los bytes '00 00 00 00' en la codificaciÃ³n  de la instrucciÃ³n <code>callq</code>â por lo que el salto serÃ¡ a la siguiente instrucciÃ³n.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>En el acceso a la variable <code>i</code> para cambiar su valor, ocurre algo parecido.
La direcciÃ³n se escribe relativa al contador de programa <code>rip</code>, pero como el compilador no sabe la posiciÃ³n definitiva de la variable, deja el desplazamiento a 0.
Por eso el desensamblado indica lo de <code>0x0(%rip)</code>, que quiere decir: direcciÃ³n desplazada 0 respecto a <code>rip</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Durante el enlazado, para generar el ejecutable definitivo, es necesario saber dÃ³nde estÃ¡n en el cÃ³digo las direcciones que se deben reubicar.
Para eso el archivo de <strong>cÃ³digo objeto</strong> lleva una <strong>tabla de reubicaciÃ³n</strong>, que tambiÃ©n se puede leer con <a href="https://man7.org/linux/man-pages/man1/objdump.1.html">objdump</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ objdump -r test.o
test.o:     file format elf64-x86-64

RELOCATION RECORDS FOR [.text]:
OFFSET           TYPE              VALUE
000000000000000b R_X86_64_PC32     i-0x0000000000000008
0000000000000025 R_X86_64_PC32     i-0x0000000000000008
0000000000000033 R_X86_64_PLT32    test-0x0000000000000004</pre>
</div>
</div>
<div class="paragraph">
<p>En nuestro ejemplo la tabla contiene tres entradas, dos para las dos instrucciones que modifican la variable <code>i</code> y una para la instrucciÃ³n <code>callq</code> que sirve para invocar <code>test()</code>.
La primera columna indica la ubicaciÃ³n en <strong>.text</strong> de la direcciÃ³n que se debe reubicar.
Mientras la segunda columna especifica el tipo de reubicaciÃ³n y la tercera contiene informaciÃ³n adicional que hace falta para realizar la reubicaciÃ³n.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, la primera entrada del ejemplo indica que debe desplazarse en <code>0x08</code> la direcciÃ³n a reubicar en <code>0x0b</code> âel acceso a <code>i</code> en <code>test()</code> para que apunte a la direcciÃ³n de la variable <code>i</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_reubicaciÃ³n_en_tiempo_de_ejecuciÃ³n"><a class="anchor" href="#_reubicaciÃ³n_en_tiempo_de_ejecuciÃ³n"></a>15.2.3. ReubicaciÃ³n en tiempo de ejecuciÃ³n</h4>
<div class="paragraph">
<p>Si un proceso puede ser movido durante su ejecuciÃ³n de un lugar de la memoria a otro, la reubicaciÃ³n de direcciones debe ser retrasada hasta el momento de la ejecuciÃ³n de cada instrucciÃ³n del programa.</p>
</div>
<div class="paragraph">
<p>Para que esto sea posible, necesitamos disponer de hardware especial que suele estar presente en la mayor parte de las CPU modernas, por lo que la inmensa mayorÃ­a de los sistemas operativos de propÃ³sito general modernos utilizan este mÃ©todo.
De Ã©l hablaremos en el <a href="memoria_principal.html#_espacio_de_direcciones_virtual_frente_a_fÃ­sico">Apartado 15.3</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_espacio_de_direcciones_virtual_frente_a_fÃ­sico"><a class="anchor" href="#_espacio_de_direcciones_virtual_frente_a_fÃ­sico"></a>15.3. Espacio de direcciones virtual frente a fÃ­sico</h3>
<div class="paragraph">
<p>En el <a href="operaciÃ³n_del_sistema_operativo.html#_protecciÃ³n_de_la_memoria">Apartado 7.3</a> vimos en los sistemas operativos modernos, como medida de protecciÃ³n, los procesos no tienen acceso libre a la memoria fÃ­sica.</p>
</div>
<div id="fig-espacio-direcciones-virtual-frente-fÃ­sico" class="imageblock">
<div class="content">
<img src="media/C15-memoria_principal/protecciÃ³n_memoria.svg" alt="protecciÃ³n memoria">
</div>
<div class="title">Figura 49. Mapeo de la memoria fÃ­sica en el espacio de direcciones virtual de un proceso.</div>
</div>
<div class="paragraph">
<p>En lugar de eso el sistema operativo âasistido por la <strong>MMU</strong> (<em>Memory-Management Unit</em>)â proporciona a cada proceso un <strong>espacio de direcciones virtual</strong> que ofrece una Â«vistaÂ» privada de la memoria, similar a la que tendrÃ­an si cada uno de los procesos estuviera siendo ejecutando en solitario (vÃ©ase la <a href="memoria_principal.html#fig-espacio-direcciones-virtual-frente-fÃ­sico">Figura 49</a>).
Es durante los accesos a la memoria principal en tiempo de ejecuciÃ³n, cuando estas <strong>direcciones virtuales</strong> son convertidas por la <strong>MMU</strong> en las <strong>direcciones fÃ­sicas</strong>, con las que realmente se accede a la memoria.
El <strong>espacio de direcciones fÃ­sico</strong> es el conjunto de direcciones fÃ­sicas que corresponden a todas las direcciones virtuales de un <strong>espacio de direcciones virtual</strong> dado.</p>
</div>
<div class="paragraph">
<p>El mecanismo de protecciÃ³n descrito es una forma muy comÃºn de <strong>reubicaciÃ³n de las direcciones en tiempo de ejecuciÃ³n</strong>, que estÃ¡ presente en la mayor parte de los sistemas operativos de propÃ³sito general modernos.
Pero, aparte de la protecciÃ³n de la memoria, algunas otras caracterÃ­sticas de dicho mecanismo son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Los procesos pueden ser cargados en cualquier zona libre de la memoria fÃ­sica e incluso movidos de una regiÃ³n a otra durante la ejecuciÃ³n de los procesos, puesto que la transformaciÃ³n de las <strong>direcciones virtuales</strong> en <strong>direcciones fÃ­sicas</strong> se realiza durante la ejecuciÃ³n de cada instrucciÃ³n.</p>
</li>
<li>
<p>El cÃ³digo generado por el compilador puede ser <strong>cÃ³digo absoluto</strong>, puesto que de antemano se sabe que todas las ubicaciones del espacio de direcciones virtual van a estar disponibles.</p>
<div class="paragraph">
<p>Lo comÃºn es que los programas se ubiquen en una direcciÃ³n fija en la parte baja del espacio de direcciones virtual.
Por ejemplo, empezando en la direcciÃ³n <code>0x00400000</code>, dejando libres los primeros 4 MiB del <strong>espacio de direcciones virtual</strong>.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Nota"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Los programas pueden ubicarse en cualquier lugar del <strong>espacio de direcciones virtual</strong>, pero no ocurre lo mismo con las <strong>librerÃ­as de enlace dinÃ¡mico</strong>, cuya posible ubicaciÃ³n va a depender del espacio ocupado por el programa y por otras <strong>librerÃ­as de enlace dinÃ¡mico</strong>.
Por tanto, como veremos en detalle mÃ¡s adelante, estas librerÃ­as deben ser reubicables en tiempo de carga.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Se puede reducir el consumo de memoria principal compartiendo las regiones de memoria fÃ­sica asignadas al cÃ³digo y los datos de solo lectura de los procesos de un mismo programa.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El cÃ³digo de un programa suele contener direcciones tanto para los saltos como para el acceso a los datos.
Al ubicar los programas en las mismas regiones de los espacios de direcciones virtuales de sus procesos, nos estamos asegurando de que el cÃ³digo en memoria de los procesos de un mismo programa es el mismo âpues todos usan las mismas direcciones virtuales absolutasâ por lo que se puede compartir la memoria fÃ­sica que ocupan.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Direcciones en ejecutables en Linux x86-64</div>
<div class="paragraph">
<p>En Linux cada proceso tiene su propio espacio de direcciones virtual, por lo que los ejecutables pueden generarse para ser cargados en una direcciÃ³n fija, ya que es seguro que no habrÃ¡ otro ocupando la misma direcciÃ³n.</p>
</div>
<div class="paragraph">
<p>Si la direcciÃ³n donde se va a ejecutar el programa puede fijarse de antemano, los ejecutables pueden contener <strong>cÃ³digo absoluto</strong>.
Por eso en Linux x86-64 el enlazador coge el <strong>cÃ³digo objeto</strong> que va a formar parte del ejecutable, lo reubica asumiendo que el ejecutable se cargarÃ¡ en cierta direcciÃ³n de la memoria y genera un ejecutable con <strong>cÃ³digo absoluto</strong>, sin <strong>tablas de reubicaciÃ³n</strong>.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, si compilamos completamente el <code>test.c</code> anterior y preguntamos por la <strong>tabla de reubicaciÃ³n</strong>, veremos que estÃ¡ vacÃ­a:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gcc -o test test.c
$ objdump -r test
test.o:     file format elf64-x86-64</pre>
</div>
</div>
<div class="paragraph">
<p>Si desensamblamos el cÃ³digo, veremos que han cambiado algunas cosas en <code>main()</code> y a <code>test()</code> respecto a lo que habÃ­a en el <strong>cÃ³digo objeto</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ objdump -d test

test.o:     file format elf64-x86-64


Disassembly of section .text:

...

0000000000001129 &lt;test&gt;:                                           <i class="conum" data-value="2"></i><b>(2)</b>
    1129:       f3 0f 1e fa             endbr64
    112d:       55                      push   %rbp
    112e:       48 89 e5                mov    %rsp,%rbp
    1131:       c7 05 d9 2e 00 00 03    movl   $0x3,0x2ed9(%rip)   <i class="conum" data-value="1"></i><b>(1)</b>
    1138:       00 00 00
    113b:       b8 00 00 00 00          mov    $0x0,%eax
    1140:       5d                      pop    %rbp
    1141:       c3                      retq

0000000000001142 &lt;main&gt;:
    1142:       f3 0f 1e fa             endbr64
    1146:       55                      push   %rbp
    1147:       48 89 e5                mov    %rsp,%rbp
    114a:       c7 05 c0 2e 00 00 01    movl   $0x1,0x2ec0(%rip)   <i class="conum" data-value="1"></i><b>(1)</b>
    1151:       00 00 00
    1154:       b8 00 00 00 00          mov    $0x0,%eax
    1159:       e8 cb ff ff ff          callq  1129 &lt;test&gt;         <i class="conum" data-value="2"></i><b>(2)</b>
    115e:       5d                      pop    %rbp
    115f:       c3                      retq

...</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Las instrucciones que acceden a la variable <code>i</code> ahora tienen el desplazamiento adecuado respecto al contador de programa <code>rip</code> para acceder a dicha variable.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>La instrucciÃ³n de salto tiene un desplazamiento que sumado al valor de <code>rip</code> lleva directamente al comienzo del cÃ³digo de la funciÃ³n <code>test()</code>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enlazado_dinÃ¡mico_y_librerÃ­as_compartidas"><a class="anchor" href="#_enlazado_dinÃ¡mico_y_librerÃ­as_compartidas"></a>15.4. Enlazado dinÃ¡mico y librerÃ­as compartidas</h3>
<div class="paragraph">
<p>Como hemos comentado anteriormente, fundamentalmente existen dos tipos de enlazado:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En el <strong>enlazado estÃ¡tico</strong>, las librerÃ­as del sistema y otros mÃ³dulos son combinados por el enlazador para formar la imagen binaria del programa que es almacenada en disco.
Algunos sistemas operativos âcomo MS-DOSâ solo soportan este tipo de enlazado.</p>
</li>
<li>
<p>En el <strong>enlazado dinÃ¡mico</strong>, este se pospone hasta la carga o la ejecuciÃ³n_ (vÃ©ase la <a href="memoria_principal.html#fig-etapas-programas-de-usuario">Figura 48</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Generalmente el enlazado dinÃ¡mico ocurre durante la carga del programa:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Durante la carga del ejecutable se comprueban las dependencias del mismo.
Estas se almacenan en el mismo archivo en disco que dicho ejecutable.</p>
</li>
<li>
<p>Las librerÃ­as a enlazar se cargan y ubican en el espacio de direcciones virtual creado para el nuevo proceso.</p>
</li>
<li>
<p>Finalmente, las referencias del programa a las funciones de cada una de las librerÃ­as cargadas se actualizan con la direcciÃ³n en memoria de las mismas.
AsÃ­ la invocaciÃ³n de las funciones por parte del programa se puede realizar de forma transparente, como si siempre hubieran formado parte del mismo.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Cuando el enlazado se va a realizar en tiempo de ejecuciÃ³n se habla de <strong>enlazado dinÃ¡mico con carga diferida</strong>.
En ese caso el procedimiento es el siguiente:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Durante el enlazado estÃ¡tico del ejecutable se pone un <em>stub</em> a cada referencia a alguna funciÃ³n de la librerÃ­a que va a ser enlazada dinÃ¡micamente.</p>
</li>
<li>
<p>Si durante la ejecuciÃ³n del programa alguna de dichas funciones es invocada, se ejecuta el <em>stub</em>.
El <em>stub</em> es una pequeÃ±a pieza de cÃ³digo que sabe como cargar la librerÃ­a, si no ha sido cargada previamente, y cÃ³mo localizar la funciÃ³n adecuada en la misma.</p>
</li>
<li>
<p>Finalmente, el <em>stub</em> se sustituye a sÃ­ mismo con la direcciÃ³n de la funciÃ³n y la invoca.
Esto permite que la siguiente ejecuciÃ³n de la funciÃ³n no incurra en ningÃºn coste adicional.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sin esta habilidad, cada programa en el sistema deberÃ­a tener, por ejemplo, una copia de la librerÃ­a del sistema incluida en su ejecutable.
Esto significa un desperdicio de espacio libre en disco y de memoria principal.
AdemÃ¡s, este esquema facilita la actualizaciÃ³n de las librerÃ­as, puesto que los programas pueden utilizar directamente las versiones actualizadas sin necesidad de volver a ser enlazados.</p>
</div>
<div class="sect3">
<h4 id="_reubicaciÃ³n_de_las_direcciones_2"><a class="anchor" href="#_reubicaciÃ³n_de_las_direcciones_2"></a>15.4.1. ReubicaciÃ³n de las direcciones</h4>
<div class="paragraph">
<p>Durante la compilaciÃ³n de una <strong>librerÃ­a dinÃ¡mica</strong> no se conoce la regiÃ³n que va a ocupar, dentro de los espacios de direcciones virtuales de los distintos procesos que la van a utilizar, por lo que es necesario generar <strong>cÃ³digo reubicable</strong>.</p>
</div>
<div class="paragraph">
<p>Atendiendo a lo visto en <a href="memoria_principal.html#_reubicaciÃ³n_en_tiempo_de_carga">Apartado 15.2.2</a> existen fundamentalmente dos estrategias:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>El compilador puede generar <strong>cÃ³digo independiente de la posiciÃ³n</strong> (PIC).
Esto permite reducir el consumo de memoria principal compartiendo las regiones de memoria fÃ­sica asignadas al cÃ³digo de una misma librerÃ­a en los distintos procesos que la utilizan, pues en todas el cÃ³digo serÃ¡ exactamente el mismo.</p>
</li>
<li>
<p>En los sistemas operativos donde no se usa cÃ³digo PIC, el compilador debe generar cÃ³digo reubicable con <strong>tablas de reubicaciÃ³n</strong>, para que la reubicaciÃ³n de las direcciones virtuales se haga en tiempo de carga.
Esto aumenta el tiempo de carga de las librerÃ­as y solo permite que compartan memoria fÃ­sica partes de la librerÃ­a que sigan siendo iguales tras la reubicaciÃ³n de las direcciones.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_librerÃ­as_compartidas"><a class="anchor" href="#_librerÃ­as_compartidas"></a>15.4.2. LibrerÃ­as compartidas</h4>
<div class="paragraph">
<p>
Habitualmente las librerÃ­as incluyen informaciÃ³n acerca de su versiÃ³n.
Esta informaciÃ³n puede ser utilizada para evitar que los programas se ejecuten con versiones incompatibles de las mismas, o para permitir que haya mÃ¡s de una versiÃ³n de cada librerÃ­a en el sistema.
AsÃ­ los viejos programas se pueden ejecutar con las viejas versiones de las librerÃ­as âo con versiones actualizadas aunque compatiblesâ mientras los nuevos programas se ejecutan con las versiones mÃ¡s recientes e incompatibles con los viejos programas.</p>
</div>
<div class="paragraph">
<p>A este sistema se lo conoce como <strong>librerÃ­as compartidas</strong>.</p>
</div>
<div class="paragraph">
<p>Para establecer correctamente la compatibilidad entre librerÃ­as y programas, es conveniente y bastante comÃºn que los desarrolladores de las <strong>librerÃ­as compartidas</strong> utilicen <strong>versionado semÃ¡ntico</strong>.
El <strong>versionado semÃ¡ntico</strong> es un convenio por el cual el nÃºmero de versiÃ³n suele venir indicado por tres nÃºmero separados por puntos âcomo, por ejemplo: 5.3.4â de tal forma que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>El primer nÃºmero es incrementado cuando ocurre un cambio drÃ¡stico en la librerÃ­a, de tal forma que seguramente los programas hechos para versiones anteriores no van a ser compatibles con la nueva versiÃ³n.</p>
</li>
<li>
<p>El segundo nÃºmero es incrementado cuando se aÃ±ade alguna nueva caracterÃ­stica o se modifica alguna ya existente, pero el cambio no debe romper los programas hechos para la versiÃ³n anterior.</p>
</li>
<li>
<p>El Ãºltimo nÃºmero es incrementado al corregir errores, pero no se rompe la compatibilidad con versiones previas.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>De esta forma, los desarrolladores pueden enlazar sus programas contra la versiÃ³n 5 de la librerÃ­a, por ejemplo, sabiendo que asÃ­ funcionarÃ¡n con cualquier versiÃ³n actualizada o corregida âcomo la 5.1, 5.2.9 o 5.10.1â pero nunca podrÃ¡n ejecutarse con versiones que tienen cambios mayores y posiblemente incompatibles âcomo la versiÃ³n 6.1 o la 2.10â.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Enlazado dinÃ¡mico en Linux x86-64</div>
<div class="paragraph">
<p>Volviendo al programa de ejemplo <code>test.c</code>, podemos obtener fÃ¡cilmente las librerÃ­as compartidas de las que depende usando el comando <a href="https://man7.org/linux/man-pages/man1/ldd.1.html">ldd</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ldd test
linux-vdso.so.1 (0x00007fffd833e000)
libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f47c20c9000)   <i class="conum" data-value="1"></i><b>(1)</b>
/lib64/ld-linux-x86-64.so.2 (0x00007f47c22cf000)                    <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>El ejecutable tiene que estar enlazado con la librerÃ­a del sistema âllamada <code>libc</code> en los sistemas POSIXâ para que pueda acceder a los servicios del sistema.
<div class="paragraph">
<p><code>libc.so.6</code> es el nombre por el que se buscarÃ¡ el archivo que contiene la librerÃ­a compartida de la librerÃ­a del sistema
Si se hubiera usado solamente <code>libc.so</code>, el ejecutable podrÃ­a intentar usar cualquier versiÃ³n de <code>libc</code>, pero al incluir el primer nÃºmero de versiÃ³n en el nombre, nos aseguramos de que el ejecutable solo usarÃ¡ versiones 6 de la librerÃ­a del sistema.
AsÃ­ se evita ejecutar el programa con versiones que pueden ser incompatibles.</p>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>La librerÃ­a <a href="https://man7.org/linux/man-pages/man8/ld.so.8.html">ld</a> se encarga de las cuestiones relacionadas con el enlazado y carga dinÃ¡mica de librerÃ­as.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si estÃ¡s librerÃ­as no estuvieran disponibles al intentar ejecutar el programa, la ejecuciÃ³n fallarÃ­a, ya que son un requisito obligatorio.
Sin embargo, el enlazado dinÃ¡mico no es algo que solo pueda configurarse durante la compilaciÃ³n para que ocurra automÃ¡ticamente durante la carga del ejecutable.
Los sistemas operativo modernos proporcionan funciones para que un proceso pueda cargar cualquier y descargar librerÃ­a durante la ejecuciÃ³n y acceder a sus variables e invocar sus funciones.
En los sistemas POSIX estas funciones las proporciona la librerÃ­a <a href="https://man7.org/linux/man-pages/man8/ld.so.8.html">ld</a>.</p>
</div>
<div class="paragraph">
<p>Esto es muy Ãºtil cuando se quiere que ciertas librerÃ­as sean opcionales.
Es decir, que no sea necesario tenerlas instaladas en el sistema donde se va a ejecutar el programa, de tal forma que si no estÃ¡n disponibles, el programa funcione con normalidad, pero si estÃ¡n instaladas, el programa aproveche la funcionalidad adicional que proporcionan.
AsÃ­ es como navegadores, editores y otros programas implementan extensiones y <em>plugins</em>, con los que el usuario puede extender la funcionalidad del programa original sin recompilarlo.
Estas extensiones generalmente se implementan como librerÃ­as compartidas que el programa busca y carga durante su ejecuciÃ³n.</p>
</div>
<div class="paragraph">
<p>Por lo general, la mayor parte de las librerÃ­as que usan los programas son enlazadas dinÃ¡micamente, pero el enlazador siempre tiene que incluir en el ejecutable algunas librerÃ­as enlazadas estÃ¡ticamente que son importantes para la ejecuciÃ³n del programa.
Por eso al ejecutar <code>objdump -d test</code> vemos funciones que no estaban ni en <code>test.c ni en el archivo de <strong>cÃ³digo objeto</strong> `test.o</code>.
La librerÃ­a que vemos incluida en el ejecutable es la <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> de C.</p>
</div>
<div class="paragraph">
<p>Todo lenguaje de programaciÃ³n âexcepto ensamblador, obviamenteâ necesita incluir en sus ejecutables una <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> o <strong>librerÃ­a de runtime</strong> con rutinas de bajo nivel que sirven de apoyo para implementar algunas caracterÃ­sticas del lenguaje y del entorno de ejecuciÃ³n.</p>
</div>
<div class="paragraph">
<p>En Linux y otros sistemas POSIX, la posiciÃ³n dÃ³nde debe iniciarse la ejecuciÃ³n se marca con la etiqueta <code>_start</code> en el ejecutable.
Se trata de cÃ³digo de la <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> que inicializa el entorno que espera el programa en C, obtiene del sistema operativo los argumentos de la lÃ­nea de comandos e invoca a la funciÃ³n <code>main()</code> de nuestro programa con ellos.
Otras funcionalidades que tÃ­picamente implementa la <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> son operaciones bÃ¡sicas de gestiÃ³n de la memoria, manejo de excepciones, comprobaciones de lÃ­mites en los _arrays_ o comprobaciones dinÃ¡micas de tipos âpor ejemplo, para implementar el operador <code>dynamic_cast</code> en C&#43;&#43;â.</p>
</div>
<div class="paragraph">
<p>Finalmente, debemos confundir la <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> con la <strong>librerÃ­a estÃ¡ndar</strong>.
En lenguajes como C o C&#43;&#43; se distingue claramente entre el lenguaje y la librerÃ­a estÃ¡ndar que suele acompaÃ±arlos.
En ese sentido, la <strong>librerÃ­a de tiempo de ejecuciÃ³n</strong> implementa lo mÃ­nimo requerido para la ejecuciÃ³n de programa en esos lenguajes.
Mientras que si ademÃ¡s queremos usar funcionalidades de su <strong>librerÃ­a estÃ¡ndar</strong>, tambiÃ©n tendremos que enlazarla, generalmente de forma dinÃ¡mica.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asignaciÃ³n_contigua_de_memoria"><a class="anchor" href="#_asignaciÃ³n_contigua_de_memoria"></a>15.5. AsignaciÃ³n contigua de memoria</h3>
<div class="paragraph">
<p>Como vimos en el <a href="operaciÃ³n_del_sistema_operativo.html#_protecciÃ³n_de_la_memoria">Apartado 7.3</a>, la memoria principal debe acomodar tanto el sistema operativo como a los diferentes procesos de los usuarios.</p>
</div>
<div class="paragraph">
<p>Normalmente queremos tener varios procesos en la memoria al mismo tiempo.
Por tanto, necesitamos considerar de quÃ© formas debemos asignar la memoria disponible a los procesos para que puedan ser cargados en ella.
En este apartado estudiaremos la tÃ©cnica mÃ¡s simple, denominada <strong>asignaciÃ³n contigua de memoria</strong>.
Mientras que en capÃ­tulos posteriores vemos tÃ©cnicas mÃ¡s avanzadas de hacer esta asignaciÃ³n.</p>
</div>
<div class="paragraph">
<p>En la <strong>asignaciÃ³n contigua de memoria</strong> a cada proceso se le asigna una Ãºnica secciÃ³n de memoria contigua.
Esto se puede hacer mediante <strong>particionado fijo</strong> o <strong>particionado dinÃ¡mico</strong></p>
</div>
<div class="sect3">
<h4 id="_particionado_fijo"><a class="anchor" href="#_particionado_fijo"></a>15.5.1. Particionado fijo</h4>
<div class="paragraph">
<p>
El <strong>particionado fijo</strong> la memoria se divide en varias secciones de tamaÃ±o fijo, cada una de las cuales contiene un proceso.
Cuando un proceso termina, se carga uno nuevo de la cola de entrada en la particiÃ³n libre.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="media/C15-memoria_principal/particionado_fijo.svg" alt="particionado fijo">
</div>
<div class="title">Figura 50. Particionado fijo de la memoria en el IBM OS/360.</div>
</div>
<div class="paragraph">
<p>Este mÃ©todo fue utilizado originalmente por el <a href="https://en.wikipedia.org/wiki/OS/360_and_successors">IBM OS/360</a>, pero ya no se utiliza</p>
</div>
</div>
<div class="sect3">
<h4 id="_particionado_dinÃ¡mico"><a class="anchor" href="#_particionado_dinÃ¡mico"></a>15.5.2. Particionado dinÃ¡mico</h4>
<div class="paragraph">
<p>
El <strong>particionado dinÃ¡mico</strong> es una generalizaciÃ³n del anterior:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>El sistema operativo mantiene una tabla indicando quÃ© partes de la memoria estÃ¡n libres y cuÃ¡les ocupadas.
Inicialmente toda la memoria estÃ¡ libre por lo que es considerada como un gran hueco de memoria disponible.</p>
</li>
<li>
<p>Cuando un proceso llega y necesita memoria, se le busca un hueco lo suficientemente grande para alojarlo.
Si se encuentra, solo se le asigna el espacio necesario, que es marcado como ocupado.
El resto sigue siendo un hueco libre, aunque de menor tamaÃ±o.</p>
</li>
<li>
<p>Si un proceso termina y se crean dos huecos adyacentes, se funden en uno solo.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>El <strong>particionado dinÃ¡mico</strong> se utilizaba fundamentalmente en <strong>sistemas de procesamiento por lotes</strong> y <strong>multiprogramados</strong>.
En este Ãºltimo caso, el sistema operativo tenÃ­a una <strong>cola de entrada</strong> ordenada por el <strong>planificador de largo plazo</strong> y la recorrÃ­a asignando memoria a los procesos, hasta que no quedara ningÃºn hueco libre con tamaÃ±o suficiente para alojar al siguiente en la cola.
Entonces el sistema operativo podÃ­a esperar hasta que algunos procesos terminarÃ¡n y hubiera un hueco lo suficientemente grande en la memoria, para el siguiente proceso, o podÃ­a seguir buscando en la cola de entrada procesos de menores requerimientos, aunque para ello tuviera que saltarse algunos procesos.</p>
</div>
<div class="paragraph">
<p>En general, en un momento dado el sistema operativo, debe satisfacer una peticiÃ³n de tamaÃ±o <em>N</em> con una lista de huecos libres de tamaÃ±o variable.
Esto no es mÃ¡s que un caso particular del problema clÃ¡sico de la asignaciÃ³n dinÃ¡mica de almacenamiento, para el cual hay diversas soluciones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>En el <strong>primer ajuste</strong> se escoge el primer hueco lo suficientemente grande como para satisfacer la peticiÃ³n.
La bÃºsqueda puede ser desde el principio de la lista o desde donde ha terminado la bÃºsqueda anterior.</p>
</li>
<li>
<p>En el <strong>mejor ajuste</strong> se escoge el hueco mÃ¡s pequeÃ±o que sea lo suficientemente grande para satisfacer la peticiÃ³n.
Indudablemente esto obliga a recorrer la lista de huecos completa o a tenerla ordenada por tamaÃ±o.</p>
</li>
<li>
<p>En el <strong>peor ajuste</strong> se escoge el hueco mÃ¡s grande.
Igualmente obliga a buscar en toda la lista de huecos o a tenerla ordenada por tamaÃ±o.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para evaluar quÃ© estrategia es la mejor, se han realizado algunas simulaciones con los siguientes resultados:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>El <strong>primer y el mejor ajuste</strong> son mejores que el peor ajuste en tÃ©rminos de menor tiempo y mayor aprovechamiento del espacio de almacenamiento.</p>
</li>
<li>
<p>Si comparamos el <strong>primer y el mejor ajuste</strong> ninguno de ellos destaca sobre el otro en lo que a mejor aprovechamiento del espacio se refiere.</p>
</li>
<li>
<p>El <strong>primer ajuste</strong> es normalmente mÃ¡s rÃ¡pido que el <strong>mejor ajuste</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fragmentaciÃ³n"><a class="anchor" href="#_fragmentaciÃ³n"></a>15.6. FragmentaciÃ³n</h3>
<div class="paragraph">
<p>
Las estrategias de asignaciÃ³n de espacio de almacenamiento generalmente sufren de problemas de <strong>fragmentaciÃ³n</strong>.
Vamos a comentar brevemente cÃ³mo afecta la <strong>fragmentaciÃ³n</strong> a la <strong>asignaciÃ³n contigua de memoria</strong>.</p>
</div>
<div class="sect3">
<h4 id="_fragmentaciÃ³n_externa"><a class="anchor" href="#_fragmentaciÃ³n_externa"></a>15.6.1. FragmentaciÃ³n externa</h4>
<div class="paragraph">
<p>
La <strong>fragmentaciÃ³n externa</strong> ocurre cuando hay suficiente espacio libre para satisfacer una peticiÃ³n, pero el espacio no es contiguo.
Es decir, el espacio de almacenamiento estÃ¡ fraccionado en un gran nÃºmero de huecos de pequeÃ±o tamaÃ±o:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Afecta tanto a la estrategia del <strong>primer</strong> como del <strong>mejor ajuste</strong>. Siendo el primero mejor en algunos sistemas y el segundo mejor en otros.</p>
</li>
<li>
<p>Algunos anÃ¡lisis estadÃ­sticos realizados con el <strong>primer ajuste</strong> revelan que incluso con algunas optimizaciones, con <em>N</em> bloques asignados se pierden 0.5<em>N</em> por <strong>fragmentaciÃ³n externa</strong> âes decir, un tercio de toda la memoria no es utilizableâ.
A esto se lo conoce como la regla del 50%.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Existen diversas soluciones a este problema:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizar tÃ©cnicas de <strong>compactaciÃ³n</strong>, lo que consiste en mover los procesos para que toda la memoria libre quede en un Ãºnico hueco de gran tamaÃ±o.
Sin embargo, esto puede ser muy caro en tÃ©rminos de tiempo y solo puede ser realizado cuando la <strong>asignaciÃ³n de direcciones absolutas se realiza en tiempo de ejecuciÃ³n</strong>.</p>
</li>
<li>
<p>La otra soluciÃ³n es permitir que el <strong>espacio de direcciones fÃ­sico</strong> de un proceso no sea contiguo.
Es decir, que la memoria puede ser asignada a un proceso independientemente de donde estÃ© disponible.
Existen dos tÃ©cnicas complementarias que utilizan esta soluciÃ³n: la paginaciÃ³n
(vÃ©ase el <a href="paginaciÃ³n.html">CapÃ­tulo 16</a>) y la <a href="https://es.wikipedia.org/wiki/Segmentaci%C3%B3n_de_memoria">segmentaciÃ³n</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_fragmentaciÃ³n_interna"><a class="anchor" href="#_fragmentaciÃ³n_interna"></a>15.6.2. FragmentaciÃ³n interna</h4>
<div class="paragraph">
<p>
La <strong>fragmentaciÃ³n interna</strong> se origina por la diferencia entre el espacio solicitado y el espacio finalmente asignado.</p>
</div>
<div class="paragraph">
<p>Supongamos un hueco de espacio libre de 12987 bytes que se va a usar para satisfacer una peticiÃ³n de 12985 bytes.
Esto genera un hueco de 2 bytes, pero la cantidad de informaciÃ³n que debemos guardar en la lista de huecos para saber que dicho hueco estÃ¡ ahÃ­, es mucho mayor que el tamaÃ±o del hueco en sÃ­ mismo.
Por lo tanto, no nos interesa tener huecos de tamaÃ±o arbitrario.</p>
</div>
<div class="paragraph">
<p>La soluciÃ³n mÃ¡s comÃºn es dividir la memoria fÃ­sica en unidades de tamaÃ±o fijo y asignarla en mÃºltiplos del tamaÃ±o de dichos bloques.
Esto hace que, en general, se asigne mÃ¡s memoria de la que realmente se ha solicitado y, por tanto, de la que realmente los procesos van a utilizar.
A esto se lo denomina <strong>fragmentaciÃ³n interna</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_intercambio"><a class="anchor" href="#_intercambio"></a>15.7. Intercambio</h3>
<div class="paragraph">
<p>
Un proceso debe estar en la memoria para ser ejecutado, pero en algunos sistemas operativos un proceso puede ser sacado de la memoria y copiado a un almacenamiento de respaldo de forma temporal âgeneralmente un dispositivo de almacenamiento secundario, como un discoâ y en algÃºn momento volver a ser traÃ­do a la memoria para continuar su ejecuciÃ³n.
Al procedimiento descrito se lo denomina <strong>intercambio</strong> o <strong><em>swapping</em></strong>.</p>
</div>
<div class="sect3">
<h4 id="_implementaciÃ³n_2"><a class="anchor" href="#_implementaciÃ³n_2"></a>15.7.1. ImplementaciÃ³n</h4>
<div class="paragraph">
<p>El <strong>intercambio</strong> se puede implementar de la siguiente manera:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>La <strong>cola de preparados</strong> contiene todos los procesos que esperan para ser ejecutados en la CPU.</p>
</li>
<li>
<p>Cuando el <strong>planificador de la CPU</strong> decide ejecutar un proceso, llama al <strong>asignador</strong>.</p>
</li>
<li>
<p>El <strong>asignador</strong> comprueba si el siguiente proceso que debe ser ejecutado estÃ¡ en la memoria.
Si no lo estÃ¡ y no hay memoria libre, el <strong>asignador</strong> hace que el <strong>gestor de la memoria</strong> intercambie el proceso con alguno de los que sÃ­ lo estÃ¡.</p>
</li>
<li>
<p>Finalmente, el <strong>asignador</strong> ejecuta el resto del cambio de contexto (vÃ©ase el <a href="procesos.html#_cambio_de_contexto">Apartado 9.6</a>) para entregar la CPU al proceso seleccionado.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Por ejemplo, si a un sistema con <strong>planificaciÃ³n de CPU</strong> basado en prioridad llega a la <strong>cola de preparados</strong> un proceso de alta prioridad, el <strong>gestor de memoria</strong> intercambia algunos procesos de baja prioridad con el de alta prioridad y ejecuta este Ãºltimo.
Cuando el proceso de alta prioridad termina, los de baja prioridad pueden ser intercambiados para continuar su ejecuciÃ³n.</p>
</div>
</div>
<div class="sect3">
<h4 id="_limitaciones"><a class="anchor" href="#_limitaciones"></a>15.7.2. Limitaciones</h4>
<div class="paragraph">
<p>Sin embargo el <strong>intercambio</strong> presenta algunas limitaciones importantes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Si un sistema <strong>reubica las direcciones en tiempo de compilaciÃ³n o carga</strong>, el proceso solo puede ser intercambiado en la misma regiÃ³n de la memoria.
Sin embargo, si se utiliza <strong>reubicaciÃ³n en tiempo de ejecuciÃ³n</strong>, entonces el proceso puede ser intercambiado en cualquier regiÃ³n de la memoria, puesto que las <strong>direcciones fÃ­sicas</strong> son calculadas durante la ejecuciÃ³n.</p>
</li>
<li>
<p>El <strong>tiempo de cambio de contexto</strong> en un sistema con <strong>intercambio</strong> puede ser mucho mayor, puesto que incluye el tiempo que se tarda en hacer el intercambio.
La mayor parte del tiempo de intercambio es el tiempo de transferencia con el disco, que puede ser de varios cientos de milisegundos, incluso utilizando los discos mÃ¡s rÃ¡pidos.
Esto afecta al <strong>tiempo de cuanto</strong> que siempre debe ser mucho mayor que el tiempo de <strong>cambio de contexto</strong>.</p>
</li>
<li>
<p>Un proceso podrÃ­a disponer de un espacio en memoria de 120 MiB pero estar utilizando solo 2 MiB.
Por tanto, es interesante que el sistema operativo conozca con exactitud la memoria utilizada por el proceso ây no la que podrÃ­a estar utilizando como mÃ¡ximoâ para reducir el tiempo de transferencia de los datos al disco durante el intercambio.</p>
<div class="paragraph">
<p>Para eso, el sistema operativo proporciona llamadas al sistema con las que un proceso con requerimientos dinÃ¡micos de memoria puede informar del cambio en su necesidad de memoria.
Por ejemplo, los sistemas operativos modernos proporcionan llamadas al sistema para reservar y liberar memoria âcomo <a href="https://en.cppreference.com/w/c/memory/malloc">malloc()</a> y <a href="https://en.cppreference.com/w/c/memory/free">free()</a> en los sistemas POSIXâ gracias a las que el sistema conoce las necesidades reales de los procesos.</p>
</div>
</li>
<li>
<p>El <strong>intercambio</strong> presenta dificultades cuando el proceso que va a ser sacado de la memoria estÃ¡ esperando por una operaciÃ³n de E/S que accede a la memoria del proceso para leer o escribir datos en ella.
Las soluciones podrÃ­an ser:</p>
<div class="ulist">
<ul>
<li>
<p>No intercambiar procesos con operaciones de E/S sÃ­ncronas o asÃ­ncronas pendientes.</p>
</li>
<li>
<p>Utilizar bÃºferes del sistema operativo en las operaciones de E/S.
Por ejemplo, en una operaciÃ³n <strong>write</strong> a un archivo, el sistema operativo copiarÃ­a primero los datos a un bÃºfer interno y luego ordenarÃ­a la escritura de esos datos.
AsÃ­ el proceso podrÃ­a ser intercambiado sin problemas.
Las transferencias entre los bÃºferes del sistema y la memoria de los procesos serÃ­an realizadas, por el sistema operativo, solo cuando los procesos residen en la memoria.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Debido fundamentalmente a que el tiempo de intercambio es muy alto, no se utiliza el intercambio estÃ¡ndar en los sistemas operativos actuales.
Lo que sÃ­ podemos encontrar en muchos sistemas son versiones modificadas de este mecanismo.</p>
</div>
<div class="paragraph">
<p>Por ejemplo, en muchas versiones antiguas de UNIX y en los sistemas modernos, el intercambio permanece desactivado y solo se activa cuando la cantidad de memoria usada supera cierto lÃ­mite.
AdemÃ¡s, en los sistemas actuales no se intercambian procesos completos si no las porciones menos usadas de cada proceso, como veremos en el <a href="memoria_virtual.html">CapÃ­tulo 17</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>âÂ Subir:Â <a href="gestiÃ³n_de_la_memoria.html">GestiÃ³n de la memoria</a>Â | âÂ Inicio:Â <a href="main.html">Sistemas Operativos</a>Â | Siguiente:Â <a href="paginaciÃ³n.html">PaginaciÃ³n</a>Â â</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<div id="footer">
    <div id="footer-text">
        Esta obra estÃ¡ sujeta a la licencia
        <a href="http://creativecommons.org/licenses/by/4.0/deed.es">Creative Commons AtribuciÃ³n 4.0 Internacional</a>,
        excepto donde se indique lo contrario.
    </div>
</div>
</body>
</html>